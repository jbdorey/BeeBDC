<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James Dorey (Script)" />
<meta name="author" content="Robert O’Reilly’ (RMD)" />


<title>A globally-synthesized and flagged bee occurrence dataset and cleaning workflow</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">@font-face{font-family:"Open Sans";font-style:normal;font-weight:400;src:local("Open Sans"),local("OpenSans"),url(data:application/font-woff;base64,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) format("woff")}@font-face{font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(data:application/font-woff;base64,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) format("woff")}*{box-sizing:border-box}body{padding:0;margin:0;font-family:"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;color:#606c71}a{color:#1e6bb8;text-decoration:none}a:hover{text-decoration:underline}.page-header{color:#fff;text-align:center;background-color:#159957;background-image:linear-gradient(120deg,#155799,#159957);padding:1.5rem 2rem}.page-header :last-child{margin-bottom:.5rem}@media screen and (max-width:42em){.page-header{padding:1rem 1rem}}.project-name{margin-top:0;margin-bottom:.1rem;font-size:2rem}@media screen and (max-width:42em){.project-name{font-size:1.75rem}}.project-tagline{margin-bottom:2rem;font-weight:400;opacity:.7;font-size:1.5rem}@media screen and (max-width:42em){.project-tagline{font-size:1.2rem}}.project-author,.project-date{font-weight:400;opacity:.7;font-size:1.2rem}@media screen and (max-width:42em){.project-author,.project-date{font-size:1rem}}.main-content,.toc{max-width:64rem;padding:2rem 4rem;margin:0 auto;font-size:1.1rem}.toc{padding-bottom:0}.toc .toc-box{padding:1.5rem;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem}.toc .toc-box .toc-title{margin:0 0 .5rem;text-align:center}.toc .toc-box>ul{margin:0;padding-left:1.5rem}@media screen and (min-width:42em) and (max-width:64em){.toc{padding:2rem 2rem 0}}@media screen and (max-width:42em){.toc{padding:2rem 1rem 0;font-size:1rem}}.main-content :first-child{margin-top:0}@media screen and (min-width:42em) and (max-width:64em){.main-content{padding:2rem}}@media screen and (max-width:42em){.main-content{padding:2rem 1rem;font-size:1rem}}.main-content img{max-width:100%}.main-content h1,.main-content h2,.main-content h3,.main-content h4,.main-content h5,.main-content h6{margin-top:2rem;margin-bottom:1rem;font-weight:400;color:#159957}.main-content p{margin-bottom:1em}.main-content code{padding:2px 4px;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;background-color:#f3f6fa;border-radius:.3rem}.main-content pre{padding:.8rem;margin-top:0;margin-bottom:1rem;font:1rem Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#567482;word-wrap:normal;background-color:#f3f6fa;border:solid 1px #dce6f0;border-radius:.3rem;line-height:1.45;overflow:auto}@media screen and (max-width:42em){.main-content pre{font-size:.9rem}}.main-content pre>code{padding:0;margin:0;color:#567482;word-break:normal;white-space:pre;background:0 0;border:0}@media screen and (max-width:42em){.main-content pre>code{font-size:.9rem}}.main-content pre code,.main-content pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.main-content pre code:after,.main-content pre code:before,.main-content pre tt:after,.main-content pre tt:before{content:normal}.main-content ol,.main-content ul{margin-top:0}.main-content blockquote{padding:0 1rem;margin-left:0;color:#819198;border-left:.3rem solid #dce6f0;font-size:1.2rem}.main-content blockquote>:first-child{margin-top:0}.main-content blockquote>:last-child{margin-bottom:0}@media screen and (max-width:42em){.main-content blockquote{font-size:1.1rem}}.main-content table{width:100%;overflow:auto;word-break:normal;word-break:keep-all;-webkit-overflow-scrolling:touch;border-collapse:collapse;border-spacing:0;margin:1rem 0}.main-content table th{font-weight:700;background-color:#159957;color:#fff}.main-content table td,.main-content table th{padding:.5rem 1rem;border-bottom:1px solid #e9ebec;text-align:left}.main-content table tr:nth-child(odd){background-color:#f2f2f2}.main-content dl{padding:0}.main-content dl dt{padding:0;margin-top:1rem;font-size:1rem;font-weight:700}.main-content dl dd{padding:0;margin-bottom:1rem}.main-content hr{height:2px;padding:0;margin:1rem 0;background-color:#eff0f1;border:0}code span.kw { color: #a71d5d; font-weight: normal; } 
code span.dt { color: #795da3; } 
code span.dv { color: #0086b3; } 
code span.bn { color: #0086b3; } 
code span.fl { color: #0086b3; } 
code span.ch { color: #4070a0; } 
code span.st { color: #183691; } 
code span.co { color: #969896; font-style: italic; } 
code span.ot { color: #007020; } 
</style>





</head>

<body>




<section class="page-header">
<h1 class="title toc-ignore project-name">A globally-synthesized and
flagged bee occurrence dataset and cleaning workflow</h1>
<h4 class="author project-author">James Dorey (Script)</h4>
<h4 class="author project-author">Robert O’Reilly’ (RMD)</h4>
<h4 class="date project-date">30 09, 2022</h4>
</section>


<div id="TOC" class="toc">
<div class="toc-box">
<ul>
<li><a href="#script-preparation" id="toc-script-preparation">0.0 Script
preparation</a>
<ul>
<li><a href="#working-directory" id="toc-working-directory">0.1 Working
directory</a></li>
<li><a href="#install-packages-if-needed" id="toc-install-packages-if-needed">0.2 Install packages (if
needed)</a></li>
<li><a href="#load-packages" id="toc-load-packages">0.3 Load
packages</a></li>
</ul></li>
<li><a href="#data-merge" id="toc-data-merge">1.0 Data merge</a>
<ul>
<li><a href="#download-ala-data" id="toc-download-ala-data">1.1 Download
ALA data</a></li>
<li><a href="#import-and-merge-ala-scan-idigbio-and-gbif-data" id="toc-import-and-merge-ala-scan-idigbio-and-gbif-data">1.2 Import and
merge ALA, SCAN, iDigBio and GBIF data</a></li>
<li><a href="#import-usgs-data" id="toc-import-usgs-data">1.3 Import
USGS Data</a></li>
<li><a href="#formatted-source-importer" id="toc-formatted-source-importer">1.4 Formatted Source
Importer</a></li>
<li><a href="#save-data" id="toc-save-data">1.5 Save data</a></li>
</ul></li>
<li><a href="#data-preperation" id="toc-data-preperation">2.0 Data
preperation</a>
<ul>
<li><a href="#standardise-datasets" id="toc-standardise-datasets">2.1
standardise datasets</a></li>
<li><a href="#integrating-paige-dataset" id="toc-integrating-paige-dataset">2.2 Integrating Paige
dataset</a></li>
<li><a href="#additional-datasets" id="toc-additional-datasets">2.3
Additional datasets</a></li>
<li><a href="#deduplicate-1" id="toc-deduplicate-1">2.4 deDuplicate
1</a></li>
</ul></li>
<li><a href="#initial-flags" id="toc-initial-flags">3.0 Initial
flags</a>
<ul>
<li><a href="#sciname" id="toc-sciname">3.1 SciName</a></li>
<li><a href="#misscoords" id="toc-misscoords">3.2 MissCoords</a></li>
<li><a href="#outofrange" id="toc-outofrange">3.3 OutOfRange</a></li>
<li><a href="#source" id="toc-source">3.4 ?Source</a></li>
<li><a href="#countryname" id="toc-countryname">3.5 CountryName</a></li>
</ul></li>
<li><a href="#remove-illegal-characters" id="toc-remove-illegal-characters">Remove illegal characters</a>
<ul>
<li><a href="#standardconames" id="toc-standardconames">3.6
StandardCoNames</a></li>
<li><a href="#transpcoords" id="toc-transpcoords">3.7
TranspCoords</a></li>
<li><a href="#coord-country" id="toc-coord-country">3.8
Coord-country</a></li>
<li><a href="#georefissue" id="toc-georefissue">3.9 GeoRefIssue</a></li>
<li><a href="#flag-absent" id="toc-flag-absent">3.10 flag
Absent</a></li>
<li><a href="#flag-license" id="toc-flag-license">3.11 flag
License</a></li>
<li><a href="#gbif-issue" id="toc-gbif-issue">3.12 GBIF issue</a></li>
<li><a href="#flag-reports" id="toc-flag-reports">3.13 Flag
Reports</a></li>
</ul></li>
<li><a href="#save-the-flags-so-far" id="toc-save-the-flags-so-far">SAVE
the flags so far</a></li>
<li><a href="#this-function-will-make-sure-that-you-keep-a-copy-of-everything-that-has-been-flagged-up-until-now." id="toc-this-function-will-make-sure-that-you-keep-a-copy-of-everything-that-has-been-flagged-up-until-now.">This
function will make sure that you keep a copy of everything that has been
flagged up until now.</a></li>
<li><a href="#this-will-be-updated-throughout-the-script-and-accessed-at-the-end-so-be-wary-of-moving-files-around-manually." id="toc-this-will-be-updated-throughout-the-script-and-accessed-at-the-end-so-be-wary-of-moving-files-around-manually.">This
will be updated throughout the script and accessed at the end, so be
wary of moving files around manually.</a>
<ul>
<li><a href="#save" id="toc-save">3.14 Save</a></li>
</ul></li>
<li><a href="#taxonomy" id="toc-taxonomy">4.0 Taxonomy</a></li>
<li><a href="#see-bdc-tutorial-herehttpsbrunobrr.github.iobdcarticlestaxonomy.html." id="toc-see-bdc-tutorial-herehttpsbrunobrr.github.iobdcarticlestaxonomy.html.">See
bdc tutorial
(here)[<span>https://brunobrr.github.io/bdc/articles/taxonomy.html</span>].<br />
</a>
<ul>
<li><a href="#prep-data-names" id="toc-prep-data-names">4.1 Prep data
names</a></li>
<li><a href="#taxo-harmonization" id="toc-taxo-harmonization">4.2 Taxo
harmonization</a></li>
<li><a href="#save-flags" id="toc-save-flags">4.3 Save flags</a></li>
</ul></li>
<li><a href="#space-the-final-frontier-or-deepspace-9-this-b" id="toc-space-the-final-frontier-or-deepspace-9-this-b">5.0 Space: The
final frontier or Deepspace 9 this B****</a>
<ul>
<li><a href="#coord-precision" id="toc-coord-precision">5.1 Coord
precision</a></li>
<li><a href="#common-spatial-issues" id="toc-common-spatial-issues">5.2
Common spatial issues</a></li>
<li><a href="#diagonal-grid" id="toc-diagonal-grid">5.3 diagonal +
grid</a></li>
<li><a href="#uncertainty" id="toc-uncertainty">5.4 Uncertainty</a></li>
<li><a href="#map-spatial-errors" id="toc-map-spatial-errors">5.5 Map
spatial errors</a></li>
<li><a href="#space-report" id="toc-space-report">5.6 Space
report</a></li>
<li><a href="#space-figures" id="toc-space-figures">5.7 Space
figures</a></li>
<li><a href="#save-flags-1" id="toc-save-flags-1">5.8 Save
flags</a></li>
<li><a href="#save-1" id="toc-save-1">5.9 Save</a></li>
</ul></li>
<li><a href="#time" id="toc-time">6.0 Time</a>
<ul>
<li><a href="#recover-dates" id="toc-recover-dates">6.1 Recover
dates</a></li>
<li><a href="#no-eventdate" id="toc-no-eventdate">6.2 No
eventDate</a></li>
<li><a href="#year-from-eventdate" id="toc-year-from-eventdate">6.3 Year
from eventDate</a></li>
<li><a href="#old-records" id="toc-old-records">6.4 Old records</a></li>
<li><a href="#time-report" id="toc-time-report">6.6 Time report</a></li>
<li><a href="#time-figures" id="toc-time-figures">6.7 Time
figures</a></li>
<li><a href="#save-flags-2" id="toc-save-flags-2">6.8 Save
flags</a></li>
</ul></li>
<li><a href="#de-duplication-2" id="toc-de-duplication-2">7.0
De-duplication 2?</a>
<ul>
<li><a href="#deduplicate" id="toc-deduplicate">7.1 deDuplicate</a></li>
</ul></li>
<li><a href="#data-filtering" id="toc-data-filtering">8.0 Data
filtering</a>
<ul>
<li><a href="#filter" id="toc-filter">8.1 Filter</a></li>
<li><a href="#rm-outliers" id="toc-rm-outliers">8.2 rm Outliers</a></li>
<li><a href="#save-uncleaned" id="toc-save-uncleaned">8.4 Save
uncleaned</a></li>
</ul></li>
<li><a href="#save-the-uncleaned-dataset" id="toc-save-the-uncleaned-dataset">Save the uncleaned dataset</a></li>
<li><a href="#summary-figures" id="toc-summary-figures">9.0 Summary
figures</a>
<ul>
<li><a href="#venn-diagrams" id="toc-venn-diagrams">9.1 Venn
diagrams</a></li>
<li><a href="#chorddiagrams" id="toc-chorddiagrams">9.2
chordDiagrams</a></li>
<li><a href="#duplicate-plot" id="toc-duplicate-plot">9.3 Duplicate
plot</a></li>
<li><a href="#database_id-figs" id="toc-database_id-figs">9.4
database_id figs</a></li>
<li><a href="#maps" id="toc-maps">9.5 Maps</a></li>
</ul></li>
<li><a href="#fin" id="toc-fin">FIN</a></li>
</ul>
</div>
</div>

<section class="main-content">
<div class="alert alert-info">
<p><strong> Attention:</strong><br />
This R script was written by James Dorey, starting on the 2nd of May
2022. The script intends to clean occurrence data from several sources
using a combination of custom functions and functions from the “bdc”
package. / For queries, please feel free to contact James Dorey at <a href="mailto:jbdorey@me.com" class="email">jbdorey@me.com</a> /</p>
<p><strong>WHAT TO ADD? Yo ucna list things here if you see the
need.</strong> /</p>
<p>This script has been independently checked and re run for
repeatability by Robert OReilly starting 13th of September 2022.
Pathways have been edited for my computer</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">error =</span> <span class="cn">TRUE</span>, <span class="at">eval =</span> <span class="cn">TRUE</span>, <span class="at">tidy =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="script-preparation" class="section level1">
<h1>0.0 Script preparation</h1>
<div id="working-directory" class="section level2">
<h2>0.1 Working directory</h2>
<p>Choose the path to the root folder in which all other folders can be
found</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>RootPath <span class="ot">&lt;-</span> <span class="st">&quot;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning&quot;</span></span></code></pre></div>
<p>Choose the location of your data</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>DataPath <span class="ot">&lt;-</span> <span class="fu">paste</span>(RootPath,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;/BeeData&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Choose the location of the R script</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ScriptPath <span class="ot">&lt;-</span> <span class="fu">paste</span>(RootPath,<span class="st">&quot;/R_scripting/BeeCleaning_SciData/R_functions&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Choose the taxonomy path</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DiscLifePath <span class="ot">&lt;-</span> <span class="fu">paste</span>(RootPath,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;/BeeData/DiscoverLife_Data&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Choose the path for the intermediate data storage</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>intermediatePath <span class="ot">&lt;-</span> <span class="fu">paste</span>(RootPath,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;/BeeData/Output/Intermediate&quot;</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Set the working directory</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(DataPath)</span></code></pre></div>
</div>
<div id="install-packages-if-needed" class="section level2">
<h2>0.2 Install packages (if needed)</h2>
<p>Install only those packages that are not already present in your
system. You may need to install gdal on your computer. This can be done
on mac by using Homebrew in the terminal and the command “brew install
gdal”. Somethtimes renv does not capture all dependancies, and will be
unable to detect packages used in certain ways</p>
<p>E.g. for (package in c(“dplyr”, “ggplot2”)) {library(package,
character.only = TRUE)}</p>
<p>can use “renv::settings<span class="math inline">\(snapshot.type(&quot;all&quot;)&quot; to capture
all packages installed in library or
&quot;renv::settings\)</span>snapshot.type(”explicit”)” and specify
packages.</p>
<pre><code>        install.packages(&quot;renv&quot;)
  
        renv::init()
  
  
        list.of.packages &lt;- c(&quot;R.utils&quot;,           # To use gunzip
                              &quot;magrittr&quot;,          # to use pipes
                              &quot;ggplot2&quot;,           #  Creates many easthetic plots
                              &quot;ggVennDiagram&quot;,     # Extends ggplot2 to make venn diagrams
                              &quot;dplyr&quot;,             #  Part of the tidyverse
                              &quot;tibble&quot;,            # To use tibbles
                              &quot;forcats&quot;,           # tidyverse for working with factors
                              &quot;tidyr&quot;,             #  Part of the tidyverse
                              &quot;rlist&quot;,             # Package to save lists
                              &quot;galah&quot;,             #  To download ALA data
                              &quot;praise&quot;,            #  To whispers sweet nothings 
                              &quot;EML&quot;,               #  To work with .eml files
                              &quot;emld&quot;,              #  To work with .eml files
                              &quot;rlang&quot;,             #  Part of the tidyverse — core functions
                              &quot;xml2&quot;,              #  Part of the tidyverse — reads .xml files
                              &quot;readr&quot;,             #  Part of the tidyverse — reads files (e.g., .csv)
                              &quot;stringr&quot;,           #  Part of the tidyverse — works with text strings
                              &quot;lubridate&quot;,         #  Part of the tidyverse — works with dates
                              &quot;tidyselect&quot;,        #  Part of the tidyverse
                              &quot;mgsub&quot;,             #  To perform multiple text substitutions
                              &quot;bdc&quot;,               # data cleaning package
                              &quot;rvest&quot;,             # Package for interfacing with and downloading from the internet
                              &quot;rnaturalearth&quot;,     #  Global vector map data 
                              &quot;rnaturalearthdata&quot;, #  To access the above global map data
                              &quot;countrycode&quot;,       # Package to deal with country codes
                              &quot;rangeBuilder&quot;,
                              &quot;rworldmap&quot;,
                              &quot;hexbin&quot;,
                              &quot;readxl&quot;,
                              &quot;cowplot&quot;,           # ggplot2 helper package
                              &quot;ggspatial&quot;)         #  Makes ggplot2 create north arrows or scale bars
  </code></pre>
<p>Install sf and terra seperately</p>
<pre><code>  renv::install(c(&quot;sf&quot;,&quot;terra&quot;), type = &quot;binary&quot;)
  renv::install(c(&quot;sf&quot;,&quot;terra&quot;), type = &quot;binary&quot;)</code></pre>
<p>List the new (not installed) packages and then if there are any,
install them.</p>
<pre><code>        renv::install(packages = c(list.of.packages, &quot;ropensci/rnaturalearthhires&quot;, &quot;mattflor/chorddiag&quot;), 
                rebuild = FALSE) # try changing to TRUE if you&#39;re having package troubles</code></pre>
</div>
<div id="load-packages" class="section level2">
<h2>0.3 Load packages</h2>
<p>Load all packages from the list specified above, with the addition of
“rnaturalearthhires”</p>
<pre><code>  lapply(c(list.of.packages, &quot;rnaturalearthhires&quot;, &quot;chorddiag&quot;, &quot;sf&quot;,&quot;terra&quot;), 
   library, character.only = TRUE)</code></pre>
<p>Load in R scripts and character strings in our package</p>
<pre><code>  sapply(list.files(file.path(ScriptPath), pattern = &quot;.R$&quot;, full.names = TRUE), source)  # loads in all functions</code></pre>
<p>Save a snapshot of the environment</p>
<pre><code>  renv::snapshot() #or
  renv::settings$snapshot.type(&quot;all&quot;)</code></pre>
<hr />
</div>
</div>
<div id="data-merge" class="section level1">
<h1>1.0 Data merge</h1>
<div id="download-ala-data" class="section level2">
<h2>1.1 Download ALA data</h2>
<p>Downloads ALA data and creates a new file in the DataPath to put
those data into.</p>
<pre><code>  ALA_downloader(path = DataPath,
           userEmail = &quot;robert.oreilly@flinders.edu.au&quot;,
           ALA_taxon = &quot;Apiformes&quot;)</code></pre>
</div>
<div id="import-and-merge-ala-scan-idigbio-and-gbif-data" class="section level2">
<h2>1.2 Import and merge ALA, SCAN, iDigBio and GBIF data</h2>
<p>Supply the path to where the data is, the save_type is either
“csv_files” or “R_file”.</p>
<pre><code>  DataImp &lt;- repo_merge(path = DataPath, save_type = &quot;R_file&quot;)


        #NOTE: this fails when using the ala data downloaded as it doe not contain  &quot;galah_DL_info.csv&quot;. Had to download this from the one drive. </code></pre>
<p>If there is errror finding a file, data_finder() will help
troubleshoot. For example:</p>
<pre><code>            #data_finder(path = DataPath)
            #OUTPUT:
            #$ALA_data
            #[1] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/ALA_galah_path/galah_download_2022-09-15/data.csv&quot;
  
            #$GBIF_data
            #[1] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0000165-220831081235567/occurrence.txt&quot;
            #[2] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436695-210914110416597/occurrence.txt&quot;
            #[3] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436697-210914110416597/occurrence.txt&quot;
            #[4] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436704-210914110416597/occurrence.txt&quot;
            #[5] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436732-210914110416597/occurrence.txt&quot;
            #[6] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436733-210914110416597/occurrence.txt&quot;
            #[7] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/GBIF_webDL_30Aug2022/0436734-210914110416597/occurrence.txt&quot;
                    
            #$iDigBio_data
            #[1] &quot;F:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/iDigBio_webDL_30Aug2022/5aa5abe1-62e0-4d8c-bebf-4ac13bd9e56f/occurrence_raw.csv&quot;
  
            #$SCAN_data
            #character(0)
            #Failing because SCAN_data seems to be missing.Downloaded separetly from the one drive</code></pre>
<p>Load in the most-recent version of these data if needed.This will
return a list with:</p>
<ol style="list-style-type: decimal">
<li>the occurrence dataset with attributes and</li>
<li>the appended eml file</li>
</ol>
<p>if meta_process = FALSE, then it will re-import as-is and be quicker.
If TRUE, it will re-import but also with extra metadata files in the
attributes and a uuid column.</p>
<pre><code>  DataImp &lt;- importOccurrences(path = DataPath,
                         meta_process = FALSE)</code></pre>
<p>Format columns</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DataImp<span class="sc">$</span>Data_WebDL <span class="ot">&lt;-</span> DataImp<span class="sc">$</span>Data_WebDL <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">type_convert</span>(<span class="at">col_types =</span> <span class="fu">ColTypeR</span>()) </span></code></pre></div>
<pre><code>## Error in DataImp$Data_WebDL %&gt;% readr::type_convert(col_types = ColTypeR()): could not find function &quot;%&gt;%&quot;</code></pre>
</div>
<div id="import-usgs-data" class="section level2">
<h2>1.3 Import USGS Data</h2>
<p>The USGS_formatter will find, import, format and create metadata for
the USGS dataset. The pubDate must be in day-month-year format.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>USGS_data <span class="ot">&lt;-</span> <span class="fu">USGS_formatter</span>(<span class="at">path =</span> DataPath, <span class="at">pubDate =</span> <span class="st">&quot;27-04-2022&quot;</span>)</span></code></pre></div>
<pre><code>## Error in USGS_formatter(path = DataPath, pubDate = &quot;27-04-2022&quot;): could not find function &quot;USGS_formatter&quot;</code></pre>
</div>
<div id="formatted-source-importer" class="section level2">
<h2>1.4 Formatted Source Importer</h2>
<p>Formatted source importer. Use this importer to find files that have
been formatted and need to be added to the larger data file. Input is
the: - strings to find and import - USGS_ &gt; finds the start of the
file name, from the USGS_formatter - [a-zA-Z_]+ &gt; Finds any words
and/or underscores - [0-9]{4}-[0-9]{2}-[0-9]{2} &gt; Finds a date in the
XXXX-XX-XX format</p>
<p>The attributes file must contain “attribute” in its name, and the
occurrence file must not.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;USGS_[a-zA-Z_]+[0-9]{4}-[0-9]{2}-[0-9]{2}&quot;</span>)</span></code></pre></div>
<p>Combine the USGS data and the existing big dataset</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Complete_data <span class="ot">&lt;-</span> <span class="fu">formatted_combiner</span>(<span class="at">path =</span> DataPath, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">strings =</span> strings, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="co"># This should be the list-format with eml attached</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">existing_data =</span> DataImp) </span></code></pre></div>
<pre><code>## Error in formatted_combiner(path = DataPath, strings = strings, existing_data = DataImp): could not find function &quot;formatted_combiner&quot;</code></pre>
<p>In the catalogNumber, remove “.*specimennumber:” as what comes after
should be the USGS number to match for duplicates</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Complete_data<span class="sc">$</span>Data_WebDL <span class="ot">&lt;-</span> Complete_data<span class="sc">$</span>Data_WebDL <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">catalogNumber =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(catalogNumber,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">pattern =</span> <span class="st">&quot;.*</span><span class="sc">\\</span><span class="st">| specimennumber:&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in Complete_data$Data_WebDL %&gt;% dplyr::mutate(catalogNumber = stringr::str_replace(catalogNumber, : could not find function &quot;%&gt;%&quot;</code></pre>
</div>
<div id="save-data" class="section level2">
<h2>1.5 Save data</h2>
<p>Choose the type of data format you want.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_saver</span>(<span class="at">path =</span> DataPath,<span class="co"># The main path to look for data in</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">save_type =</span> <span class="st">&quot;CSV_file&quot;</span>, <span class="co"># &quot;R_file&quot; OR &quot;CSV_file&quot;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">occurrences =</span> Complete_data<span class="sc">$</span>Data_WebDL, <span class="co"># The existing datasheet</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">eml_files =</span> Complete_data<span class="sc">$</span>eml_files, <span class="co"># The existing EML files</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">file_prefix =</span> <span class="st">&quot;Fin_&quot;</span>) <span class="co"># The prefix for the filenames</span></span></code></pre></div>
<pre><code>## Error in data_saver(path = DataPath, save_type = &quot;CSV_file&quot;, occurrences = Complete_data$Data_WebDL, : could not find function &quot;data_saver&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Complete_data, DataImp)</span></code></pre></div>
</div>
</div>
<div id="data-preperation" class="section level1">
<h1>2.0 Data preperation</h1>
<div id="standardise-datasets" class="section level2">
<h2>2.1 standardise datasets</h2>
<p>You may either use:</p>
<pre><code>- (a) the bdc import method (works well with general datasets) ***or*** 
- (b) the jbd import method (works well with above data merge)
- (?c) &lt;mark&gt;Add the c method thats below in here?&lt;/mark&gt;</code></pre>
<div id="a.-bdc-import" class="section level3">
<h3>a. bdc import</h3>
<p>Read in the bdc metadata</p>
<pre><code>  bdc_metadata &lt;- readr::read_csv(paste(DataPath, &quot;Output&quot;, &quot;bdc_integration.csv&quot;, sep = &quot;/&quot;))
        
        # ?issue — datasetName is a darwinCore field already!</code></pre>
<p>Standardise the dataset to bdc</p>
<pre><code>  db_standardized &lt;- bdc::bdc_standardize_datasets(
    metadata = bdc_metadata,
    format = &quot;csv&quot;,
    overwrite = TRUE,
    save_database = TRUE)</code></pre>
<p>read in configuration description file of the column header info</p>
<pre><code>  config_description &lt;- readr::read_csv(paste(DataPath, &quot;Output&quot;, &quot;bdc_configDesc.csv&quot;,
                                              sep = &quot;/&quot;), 
                                        show_col_types = FALSE, trim_ws = TRUE)</code></pre>
</div>
<div id="b.-jbd-import" class="section level3">
<h3>b. jbd import</h3>
<p>You can also just read the data in using the below script. This will
likely be quicker and more-reliable. /</p>
<p>Find the path</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>occPath <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath, <span class="at">fileName =</span> <span class="st">&quot;Fin_BeeData_combined_&quot;</span>)</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;Fin_BeeData_combined_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<p>read in the file</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(occPath, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># Use the basic ColTypeR function to determine types</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">col_types =</span> <span class="fu">ColTypeR</span>(), <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in standardise_path(file): object &#39;occPath&#39; not found</code></pre>
<p>add the database_id columnq</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="ot">&lt;-</span> db_standardized <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">database_id =</span> <span class="fu">paste</span>(<span class="st">&quot;Dorey_data_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(db_standardized), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> family)</span></code></pre></div>
<pre><code>## Error in db_standardized %&gt;% dplyr::mutate(database_id = paste(&quot;Dorey_data_&quot;, : could not find function &quot;%&gt;%&quot;</code></pre>
</div>
<div id="c.-match-database_id" class="section level3">
<h3>c. match database_id</h3>
<p><mark>Note: a and b sections are for different methods of data
import. Maybe add C option above where talking about the two
imports</mark> /</p>
<p>IF you have prior runs from which you’d like to match database_ids
with from the current run. You may use the below script to try to match
database IDs with prior runs./</p>
<p>read in a prior run of choice</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>priorRun <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">file =</span> <span class="st">&quot;01_prefilter_database_9Aug22.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> ., <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, file = &quot;01_prefilter_database_9Aug22.csv&quot;) %&gt;% : could not find function &quot;%&gt;%&quot;</code></pre>
<p>Which datasets are static and should be excluded from matching?</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>excludeDataset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ASP&quot;</span>, <span class="st">&quot;BMin&quot;</span>, <span class="st">&quot;BMont&quot;</span>, <span class="st">&quot;CAES&quot;</span>, <span class="st">&quot;EaCO&quot;</span>, <span class="st">&quot;Ecd&quot;</span>, <span class="st">&quot;EcoS&quot;</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;Gai&quot;</span>, <span class="st">&quot;KP&quot;</span>, <span class="st">&quot;SFU&quot;</span>, <span class="st">&quot;USGS&quot;</span>)</span></code></pre></div>
<p>This function will attempt to find the database_ids from prior
runs</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;idMatchR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="ot">&lt;-</span> <span class="fu">idMatchR</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">currentData =</span> db_standardized,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">priorData =</span> priorRun,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First matches will be given preference over later ones</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">matchBy =</span> tibble<span class="sc">::</span><span class="fu">lst</span>(<span class="fu">c</span>(<span class="st">&quot;gbifID&quot;</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;recordId&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Because INHS was entered as it&#39;s own dataset but is now included in the GBIF download...</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>)),</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># You can exclude datasets from prior by matching their prefixs — before first underscore:</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">excludeDataset =</span> excludeDataset)</span></code></pre></div>
<pre><code>## Loading required package: dplyr</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Loading required package: stringr</code></pre>
<pre><code>## Loading required package: tidyselect</code></pre>
<pre><code>## Loading required package: tidyr</code></pre>
<pre><code>## Error in idMatchR(currentData = db_standardized, priorData = priorRun, : object &#39;db_standardized&#39; not found</code></pre>
<p>Remove redundant files</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(priorRun, excludeDataset)</span></code></pre></div>
</div>
<div id="d.-optional-thin" class="section level3">
<h3>d. optional thin</h3>
<p><mark>same as c</mark></p>
<p>You can thin the dataset for <strong><em>TESTING ONLY!</em></strong>
check_pf &lt;- check_pf %&gt;% # take every 100th record
filter(row_number() %% 100 == 1)</p>
<hr />
</div>
</div>
<div id="integrating-paige-dataset" class="section level2">
<h2>2.2 Integrating Paige dataset</h2>
<p>Paige Chesshire’s cleaned American dataset. /</p>
<div id="import-data" class="section level3">
<h3>Import data</h3>
<p>IF you haven’t figured out by now, dont worry about the column name
warning — not all columns occur here.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>PaigeNAm <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;Paige_data&quot;</span>, <span class="st">&quot;NorAmer_highQual_only_ALLfamilies.csv&quot;</span>,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change the column name from Source to dataSource to match the rest of the data.</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">dataSource =</span> Source) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># EXTRACT WAS HERE</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a NEW database_id column</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">database_id =</span> <span class="fu">paste0</span>(<span class="st">&quot;Paige_data_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> scientificName)</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<p>This is a list of columns by which to match paige’s data to the
most-recent download with. Each vector will be matched indiviudally.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>columnList <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;recordNumber&quot;</span>, <span class="st">&quot;recordedBy&quot;</span>, <span class="st">&quot;individualCount&quot;</span>, <span class="st">&quot;samplingProtocol&quot;</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;associatedTaxa&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>, <span class="st">&quot;otherCatalogNumbers&quot;</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;recordId&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;collectionID&quot;</span>),         <span class="co"># Iteration 1</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>, <span class="st">&quot;otherCatalogNumbers&quot;</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;recordId&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;collectionID&quot;</span>), <span class="co"># Iteration 2</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>, </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;recordedBy&quot;</span>, <span class="st">&quot;genus&quot;</span>, <span class="st">&quot;specificEpithet&quot;</span>),<span class="co"># Iteration 3</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>),<span class="co"># Iteration 4</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;recordedBy&quot;</span>, <span class="st">&quot;genus&quot;</span>, <span class="st">&quot;specificEpithet&quot;</span>, <span class="st">&quot;locality&quot;</span>), <span class="co"># Iteration 5</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;recordedBy&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>, <span class="st">&quot;genus&quot;</span>, </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;specificEpithet&quot;</span>,<span class="st">&quot;locality&quot;</span>),<span class="co"># Iteration 6</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;occurrenceID&quot;</span>,<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>),<span class="co"># Iteration 7</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>,<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>),<span class="co"># Iteration 8</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;locality&quot;</span>) <span class="co"># Iteration 9</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div>
</div>
<div id="merge-paiges-data-with-downloaded-data" class="section level3">
<h3>Merge Paige’s data with downloaded data</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;PaigeIntegrater.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="ot">&lt;-</span> <span class="fu">PaigeIntegrater</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">db_standardized =</span> db_standardized,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PaigeNAm =</span> PaigeNAm,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnStrings =</span> columnList)</span></code></pre></div>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Error in dplyr::filter(., complete.cases(occurrenceID)): object &#39;db_standardized&#39; not found</code></pre>
<p>Remove spent data</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(PaigeNAm)</span></code></pre></div>
</div>
</div>
<div id="additional-datasets" class="section level2">
<h2>2.3 Additional datasets</h2>
<div id="import-additional-and-potentially-private-datasets." class="section level3">
<h3>Import additional and potentially private datasets.</h3>
<p><strong>Note:</strong>Private dataset functions are provided but the
data not integrated here until those datasets become freely
available.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;additionalData_readRs.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<div id="a.-canada" class="section level4">
<h4>a. Canada</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>SFU_Data <span class="ot">&lt;-</span> <span class="fu">SFU_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/bee_data_canada.csv&quot;</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">outFile =</span> <span class="st">&quot;jbd_SFU_data.csv&quot;</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: readr</code></pre>
<pre><code>## Loading required package: lubridate</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<pre><code>## Loading required package: mgsub</code></pre>
<pre><code>## Rows: 50171 Columns: 15
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (10): catalog_number, pollinator_family, pollinator_genus, pollinator_sp...
## dbl  (5): collector_number, day_collected, year_collected, latitude, longitude
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="b.-allan-smith-pardo" class="section level4">
<h4>b. Allan Smith-Pardo</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ASP_Data <span class="ot">&lt;-</span> <span class="fu">ASP_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Allan_Smith-Pardo_Dorey_ready2.csv&quot;</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">outFile =</span> <span class="st">&quot;jbd_ASP_data.csv&quot;</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 15356 Columns: 21
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (16): family, subfamily, Tribe, genus, subgenus, Morphospecies, specific...
## dbl  (5): catalogNumber, decimalLatitude, decimalLongitude, coordinateUncert...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="c.-minckley" class="section level4">
<h4>c. Minckley</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>BMin_Data <span class="ot">&lt;-</span> <span class="fu">BMin_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Bob_Minckley_6_1_22_ScanRecent-mod_Dorey.csv&quot;</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outFile =</span> <span class="st">&quot;jbd_BMin_data.csv&quot;</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1507 Columns: 24
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (22): catalogNumber, Phylum, higherClassification, Order, family, genus,...
## dbl  (2): decimalLatitude, decimalLongitude
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="d.-bmont" class="section level4">
<h4>d. BMont</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>BMont_Data <span class="ot">&lt;-</span> <span class="fu">BMont_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Bombus_Montana_dorey.csv&quot;</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">outFile =</span> <span class="st">&quot;jbd_BMont_data.csv&quot;</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 7799 Columns: 41
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (32): occurence_lsid, language, basisOfRecord, catalogNumber, scientifi...
## dbl   (4): organismQuantity, decimalLatitude, decimalLongitude, dateIdentified
## lgl   (4): municipality, fieldNumber, infraspecificEpithet, habitat
## dttm  (1): modified
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="e.-ecd" class="section level4">
<h4>e. Ecd</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Ecd_Data <span class="ot">&lt;-</span> <span class="fu">Ecd_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Ecdysis_occs.csv&quot;</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">outFile =</span> <span class="st">&quot;jbd_Ecd_data.csv&quot;</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 28962 Columns: 91
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (56): institutionCode, collectionCode, ownerInstitutionCode, basisOfReco...
## dbl (18): id, taxonID, recordNumber, year, month, day, startDayOfYear, endDa...
## lgl (17): verbatimTaxonRank, identificationQualifier, substrate, verbatimAtt...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="f.-gai" class="section level4">
<h4>f. Gai</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Gai_Data <span class="ot">&lt;-</span> <span class="fu">Gai_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/upload_to_scan_Gaiarsa et al_Dorey.csv&quot;</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">outFile =</span> <span class="st">&quot;jbd_Gai_data.csv&quot;</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## Rows: 11500 Columns: 48
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (36): institutionCode, Collection Code, ...3, catalogNumber, sex, ident... dbl
## (10): Other Catalog Number, SampleRound, TempStart, TempEnd, WindStart,... time
## (2): eventTime, EndTime
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...3`</code></pre>
</div>
<div id="g.-caes" class="section level4">
<h4>g. CAES</h4>
<p>This is a little slower and will have a few date warnings — 215
failed to parse.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>CAES_Data <span class="ot">&lt;-</span> <span class="fu">CAES_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/CT_Bee_Data.csv&quot;</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outFile =</span> <span class="st">&quot;jbd_CT_Data.csv&quot;</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 30721 Columns: 54
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (43): Unique identifier, Genus, species, Scientific Name, Country, State...
## dbl  (7): Lat, Lon, Det_Date, Spec_Count, Elev_m, Elev_f, OrigUSI
## lgl  (4): Accuracy, DNA, Host_subspecies, Host_Author
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="h.-kp" class="section level4">
<h4>h. KP</h4>
<p>This is a little slower and will have a few date warnings — 215
failed to parse.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a> KP_Data <span class="ot">&lt;-</span> <span class="fu">KP_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/KP_output.xlsx&quot;</span>,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">outFile =</span> <span class="st">&quot;jbd_KP_Data.csv&quot;</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dataLicense =</span> <span class="st">&quot;All rights reserved&quot;</span>)</span></code></pre></div>
<pre><code>## Error: `path` does not exist: &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Additional_Datasets//InputDatasets/KP_output.xlsx&#39;</code></pre>
</div>
<div id="i.-inhs" class="section level4">
<h4>i. INHS</h4>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a> INHS_Data <span class="ot">&lt;-</span> <span class="fu">INHS_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/INHS_Bees_webreq_DwC-A/INHS_occurrences.csv&quot;</span>,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">outFile =</span> <span class="st">&quot;occurrences_INHS.csv&quot;</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
</div>
<div id="j.-ecos" class="section level4">
<h4>j. EcoS</h4>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>EcoS_Data <span class="ot">&lt;-</span> <span class="fu">EcoS_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/database_ecosur_cecon_shared.csv&quot;</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">outFile =</span> <span class="st">&quot;jbd_EcoS_Data.csv&quot;</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dataLicense =</span> <span class="st">&quot;All rights reserved&quot;</span>)</span></code></pre></div>
<pre><code>## Error: &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Additional_Datasets//InputDatasets/database_ecosur_cecon_shared.csv&#39; does not exist.</code></pre>
</div>
<div id="k.-geol" class="section level4">
<h4>k. GeoL</h4>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>GeoL_Data <span class="ot">&lt;-</span> <span class="fu">GeoL_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Geolocate and BELS_certain and accurate.xlsx&quot;</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outFile =</span> <span class="st">&quot;jbd_GeoL_Data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...14`
## • `` -&gt; `...42`
## • `` -&gt; `...45`
## • `` -&gt; `...57`
## • `` -&gt; `...61`</code></pre>
<pre><code>## Error in `dplyr::select()`:
## ! could not find function &quot;ColTypeR&quot;</code></pre>
</div>
<div id="l.-eaco" class="section level4">
<h4>l. EaCO</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>EaCO_Data <span class="ot">&lt;-</span> <span class="fu">EaCO_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/Eastern Colorado bee 2017 sampling.xlsx&quot;</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outFile =</span> <span class="st">&quot;jbd_EaCo_Data.csv&quot;</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dataLicense =</span> <span class="st">&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span>)</span></code></pre></div>
<pre><code>## Error in `dplyr::select()`:
## ! could not find function &quot;ColTypeR&quot;</code></pre>
</div>
<div id="m.-mabc" class="section level4">
<h4>m. MABC</h4>
<p>Data from Diego E. de Pedro</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>MABC_Data <span class="ot">&lt;-</span> <span class="fu">MABC_readr</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>),</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">inFile =</span> <span class="st">&quot;/InputDatasets/MABC_dataset.xlsx&quot;</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">outFile =</span> <span class="st">&quot;jbd_MABC_Data.csv&quot;</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dataLicense =</span> <span class="st">&quot;All rights reserved&quot;</span>)</span></code></pre></div>
<pre><code>## Error: `path` does not exist: &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Additional_Datasets//InputDatasets/MABC_dataset.xlsx&#39;</code></pre>
</div>
</div>
<div id="merge-all" class="section level3">
<h3>Merge all</h3>
<p>Remove these spent datasets</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(SFU_Data, ASP_Data, BMin_Data, BMont_Data, Ecd_Data, Gai_Data, CAES_Data, </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># INHS_Data, MABC_Data, EcoS_Data, KP_Data,</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>   GeoL_Data, EaCO_Data)</span></code></pre></div>
<p>Read in and merge all</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="ot">&lt;-</span> db_standardized <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_ASP_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_SFU_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_BMin_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_BMont_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_Ecd_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_Gai_data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_CT_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>     readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;/jbd_KP_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>     readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;/jbd_INHS_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>     readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;/jbd_EcoS_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_GeoL_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()),</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;/jbd_EaCo_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>()), </span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>     readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Additional_Datasets&quot;</span>, </span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;/jbd_MABC_Data.csv&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>   <span class="co"># </span><span class="re">END</span><span class="co"> bind_rows</span></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(<span class="at">classes =</span> <span class="st">&quot;warning&quot;</span>) <span class="co"># End suppressWarnings — due to col_types</span></span></code></pre></div>
<pre><code>## Error in list2(...): object &#39;db_standardized&#39; not found</code></pre>
</div>
</div>
<div id="deduplicate-1" class="section level2">
<h2>2.4 deDuplicate 1</h2>
<p>We will FLAG duplicates here. Duplicate flagging can be based on
“ID”:<br />
- user-specified — idColumns — This is done ITERATIVELY across these
columns or based on collectInfoColumns. This will use a set of core
columns - user-defined — collectionColsAND then with the above columns,
extra columns individually - user-defined — collectInfoColumns — This is
done ITERATIVELY across these columns # These could be hacked to
de-duplicate as you wish. # source(paste(ScriptPath,
“jbd_dupeSummary.R”, sep = “/”)) # db_standardized &lt;-
jbd_dupeSummary( # data = db_standardized, # path = DataPath, # # If you
want to append a prior run’s file, insert the file path here. #
appendPath = NULL, # # Years ABOVE this will not be used to sort
dateIdentified # maxYear = lubridate::year(Sys.Date()), # # Years BELOW
this will not be used to sort dateIdentified # minYear = 1700, # #
options are “ID”,“collectionInfo”, or “both” # duplicatedBy = “ID”, #
I’m only running ID for the first lot because we might recover other
info later # # The columns to generate completeness info from #
completeness_cols = c(“decimalLatitude”, “decimalLongitude”, #
“scientificName”, “eventDate”), # idColumns = c(“gbifID”,
“occurrenceID”, “recordId”,“id”), # # The columns to ADDITIONALLY
consider when finding duplicates in collectionInfo # collectionCols =
c(“decimalLatitude”, “decimalLongitude”, “scientificName”, “eventDate”,
# “recordedBy”), # # The columns to combine, one-by-one with the
collectionCols # collectInfoColumns = c(“recordNumber”, “eventID”,
“catalogNumber”, “otherCatalogNumbers”, # “collectionID”), # # Custom
comparisons — as a list of # CustomComparisons =
tibble::lst(c(“catalogNumber”, “institutionCode”)), # # The order in
which you want to KEEP duplicated based on data source # # try
unique(db_standardized$dataSource) # sourceOrder = c(“CAES”, “Gai”,
“Ecd”,“BMont”, “BMin”, “SFU”, “ASP”, “KP”, “USGS”, # “ALA”,
“GBIF”,“SCAN”,“iDigBio”), # # To preference Paige’s data over the RAW
GBIF data, use the below # PaigeSort = TRUE, # # To remove duplicates
from CONSIDERATION once they are identified = TRUE, # # or not= FALSE
(by iteration) # consecutiveRemoval = FALSE # ) # END jbd_dupeSummary #
Save the dataset</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>db_standardized <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;00_prefilter_database.csv&quot;</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;db_standardized&#39; not found</code></pre>
</div>
</div>
<div id="initial-flags" class="section level1">
<h1>3.0 Initial flags</h1>
<p>Read data back in if needed check_pf &lt;-
readr::read_csv(paste(DataPath, “Output”, “Intermediate”,
“00_prefilter_database.csv”, sep = “/”), col_types = ColTypeR())</p>
<p>See (here)[<a href="https://brunobrr.github.io/bdc/articles/prefilter.html" class="uri">https://brunobrr.github.io/bdc/articles/prefilter.html</a>]
for bdc tutorial.</p>
<div id="sciname" class="section level2">
<h2>3.1 SciName</h2>
<p>Flag occurrences without scientificName provided</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_scientificName_empty</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> db_standardized,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sci_name =</span> <span class="st">&quot;scientificName&quot;</span>)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_scientificName_empty(data = db_standardized, sci_name = &quot;scientificName&quot;): object &#39;db_standardized&#39; not found</code></pre>
<p>now that this is saved, remove it to save space in memory</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(db_standardized) </span></code></pre></div>
</div>
<div id="misscoords" class="section level2">
<h2>3.2 MissCoords</h2>
<p>Flag occurrences with missing lat and lon</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_coordinates_empty</span>(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>)</span></code></pre></div>
<pre><code>## Error in is.data.frame(data): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="outofrange" class="section level2">
<h2>3.3 OutOfRange</h2>
<p>Flag occurrences that are not on earth (outside of -180 to 180 or -90
to 90 degrees)</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_coordinates_outOfRange</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::select(., .data[[lon]], .data[[lat]]): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="source" class="section level2">
<h2>3.4 ?Source</h2>
<p>Flag occurrences that don’t match the basisOfRecord types below</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_basisOfRecords_notStandard</span>(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">basisOfRecord =</span> <span class="st">&quot;basisOfRecord&quot;</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to_keep =</span> <span class="fu">c</span>(</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep all plus some at the bottom.</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Event&quot;</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;HUMAN_OBSERVATION&quot;</span>,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;HumanObservation&quot;</span>,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LIVING_SPECIMEN&quot;</span>,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LivingSpecimen&quot;</span>,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;MACHINE_OBSERVATION&quot;</span>,</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;MachineObservation&quot;</span>,</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;MATERIAL_SAMPLE&quot;</span>,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;O&quot;</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Occurrence&quot;</span>,</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;MaterialSample&quot;</span>,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;OBSERVATION&quot;</span>,</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Preserved Specimen&quot;</span>,</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PRESERVED_SPECIMEN&quot;</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;preservedspecimen Specimen&quot;</span>,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Preservedspecimen&quot;</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;PreservedSpecimen&quot;</span>,</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;preservedspecimen&quot;</span>,</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;S&quot;</span>,</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Specimen&quot;</span>,</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Taxon&quot;</span>,</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;UNKNOWN&quot;</span>,</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;</span>,</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>,</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;NA&quot;</span>,</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;LITERATURE&quot;</span>, </span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;None&quot;</span>, <span class="st">&quot;Pinned Specimen&quot;</span>, <span class="st">&quot;Voucher reared&quot;</span>, <span class="st">&quot;Emerged specimen&quot;</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., .basisOfRecords_notStandard = tolower(.data[[basisOfRecord]]) %in% : object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="countryname" class="section level2">
<h2>3.5 CountryName</h2>
<p>Try to harmonise country names./</p>
<p>Create a Tibble of common issues in country names and their
replacements</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>commonProblems <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">problem =</span> <span class="fu">c</span>(<span class="st">&#39;U.S.A.&#39;</span>, <span class="st">&#39;US&#39;</span>,<span class="st">&#39;USA&#39;</span>,<span class="st">&#39;usa&#39;</span>,<span class="st">&#39;UNITED STATES&#39;</span>,<span class="st">&#39;United States&#39;</span>,<span class="st">&#39;U.S.A&#39;</span>,<span class="st">&#39;MX&#39;</span>,<span class="st">&#39;CA&#39;</span>,<span class="st">&#39;Bras.&#39;</span>,<span class="st">&#39;Braz.&#39;</span>,<span class="st">&#39;Brasil&#39;</span>,<span class="st">&#39;CNMI&#39;</span>,<span class="st">&#39;USA TERRITORY: PUERTO RICO&#39;</span>),</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fix =</span> <span class="fu">c</span>(<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;United States of America&#39;</span>,<span class="st">&#39;Mexico&#39;</span>,<span class="st">&#39;Canada&#39;</span>,<span class="st">&#39;Brazil&#39;</span>,<span class="st">&#39;Brazil&#39;</span>,<span class="st">&#39;Brazil&#39;</span>,<span class="st">&#39;Northern Mariana Islands&#39;</span>,<span class="st">&#39;PUERTO.RICO&#39;</span>))</span></code></pre></div>
<div id="a.-prepare-dataset" class="section level3">
<h3>a. prepare dataset</h3>
<p>Fix up country names based on common problems above and extract ISO2
codes for occurrences</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_countryNameCleanR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>check_pf_noNa <span class="ot">&lt;-</span> <span class="fu">jbd_countryNameCleanR</span>(</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">commonProblems =</span> commonProblems)</span></code></pre></div>
<pre><code>## Error in jbd_countryNameCleanR(data = check_pf, commonProblems = commonProblems): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="b.-run-function" class="section level3">
<h3>b. run function</h3>
<p>Get country name from coordinates using a wrapper around the
bdc_country_from_coordinates function. Because our dataset is much
larger than those used to design bdc, we have made it so that you can
analyse data in smaller pieces.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_CfC_chunker.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  countryOutput <span class="ot">&lt;-</span> <span class="fu">jbd_CfC_chunker</span>(<span class="at">data =</span> check_pf_noNa,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">country =</span> <span class="st">&quot;country&quot;</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># How many rows to process at a time</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stepSize =</span> <span class="dv">1000000</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># Start row</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">chunkStart =</span> <span class="dv">1</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">append =</span> <span class="cn">FALSE</span>),</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">classes =</span> <span class="st">&quot;warning&quot;</span>)</span></code></pre></div>
<pre><code>## Error in nrow(data): object &#39;check_pf_noNa&#39; not found</code></pre>
</div>
<div id="c.-re-merge" class="section level3">
<h3>c. re-merge</h3>
<p>Left join these datasets</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(check_pf, countryOutput, <span class="at">by =</span> <span class="st">&quot;database_id&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># merge the two country name columns into the &quot;country&quot; column</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">country =</span> dplyr<span class="sc">::</span><span class="fu">coalesce</span>(country.x, country.y)) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove the now redundant country columns </span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(country.x, country.y)) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put the column back in its original place</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(country, <span class="at">.after =</span> basisOfRecord) <span class="sc">%&gt;%</span> </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove duplicates if they arose!</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## Error in left_join(check_pf, countryOutput, by = &quot;database_id&quot;): object &#39;check_pf&#39; not found</code></pre>
</div>
</div>
</div>
<div id="remove-illegal-characters" class="section level1">
<h1>Remove illegal characters</h1>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>check_pf<span class="sc">$</span>country <span class="ot">&lt;-</span> check_pf<span class="sc">$</span>country <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="at">pattern =</span> <span class="fu">paste</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">?&quot;</span>,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep=</span>  <span class="st">&quot;|&quot;</span>), <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Error in stri_replace_first_regex(string, pattern, fix_replacement(replacement), : object &#39;check_pf&#39; not found</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the problems as they occur</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> check_pf <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(commonProblems, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span> <span class="ot">=</span> <span class="st">&quot;problem&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">country =</span> </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">if_else</span>(country <span class="sc">%in%</span> commonProblems<span class="sc">$</span>problem,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>                                 fix, country)) <span class="sc">%&gt;%</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>fix)</span></code></pre></div>
<pre><code>## Error in dplyr::left_join(., commonProblems, by = c(country = &quot;problem&quot;)): object &#39;check_pf&#39; not found</code></pre>
<p>Save the dataset</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;01_prefilter_database.csv&quot;</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
<p>Read in IF needed # check_pf &lt;- readr::read_csv(paste(DataPath, #
“Output”, “Intermediate”, “01_prefilter_database.csv”, sep = “/”), #
col_types = ColTypeR())</p>
<p>remove the interim datasets</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(check_pf_noNa, countryOutput, GBIF_occs)</span></code></pre></div>
<div id="standardconames" class="section level2">
<h2>3.6 StandardCoNames</h2>
<p>Remove the countryCode and country_suggested columns to avoid an
error with bdc_country_standardized where two “countryCode” columns
exist.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> check_pf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>tidyselect<span class="sc">::</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">&quot;countryCode&quot;</span>, <span class="st">&quot;country_suggested&quot;</span>))) </span></code></pre></div>
<pre><code>## Error in dplyr::select(., !tidyselect::any_of(c(&quot;countryCode&quot;, &quot;country_suggested&quot;))): object &#39;check_pf&#39; not found</code></pre>
<p>Run the function (Standardise country names and add ISO2 codes if
needed).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_country_standardized</span>(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="st">&quot;country&quot;</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Put country_suggested into the country column (otherwise this column is a useless mess)</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">country =</span> country_suggested)</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="transpcoords" class="section level2">
<h2>3.7 TranspCoords</h2>
<p>Flag and correct records when lat and long appear to be transposed.
We have chunked this because it is too RAM-heavy to run on our large
dataset.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">jbd_Ctrans_chunker</span>(</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bdc_coordinates_transposed inputs</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="st">&quot;country_suggested&quot;</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">countryCode =</span> <span class="st">&quot;countryCode&quot;</span>,</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">border_buffer =</span> <span class="fl">0.2</span>, <span class="co"># in decimal degrees (~22 km at the equator)</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_outputs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sci_names =</span> <span class="st">&quot;scientificName&quot;</span>,</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># chunker inputs</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepSize =</span> <span class="dv">1000000</span>,  <span class="co"># How many rows to process at a time</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunkStart =</span> <span class="dv">1</span>,  <span class="co"># Start row</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">append =</span> <span class="cn">FALSE</span>  <span class="co"># If FALSE it may overwrite existing dataset</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>) <span class="co">#, classes = &quot;warning&quot;)</span></span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:18:0: unexpected end of input
## 16:   append = FALSE  # If FALSE it may overwrite existing dataset
## 17: ) #, classes = &quot;warning&quot;)
##    ^</code></pre>
<p>Get a summary of the number of transposed records.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(check_pf<span class="sc">$</span>coordinates_transposed, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## Error in table(check_pf$coordinates_transposed, useNA = &quot;always&quot;): object &#39;check_pf&#39; not found</code></pre>
<p>Save the dataset</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;01_prefilter_database.csv&quot;</span>,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 3170811 169.4    4720285 252.1  4720285 252.1
## Vcells 4750149  36.3   16065532 122.6 19804391 151.1</code></pre>
<p>Read data in again if needed # check_pf &lt;-
readr::read_csv(paste(DataPath,“Output”, “Intermediate”,
“01_prefilter_database.csv”, # sep = “/”))</p>
</div>
<div id="coord-country" class="section level2">
<h2>3.8 Coord-country</h2>
<p>Collect all country names in the country_suggested column. We rebult
a bdc function to flag occurrences where the coordinates are incosistent
with the provided country name.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_coordCountryInconsistent.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">jbd_coordCountryInconsistent</span>(</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapResolution =</span> <span class="dv">50</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointBuffer =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## Loading required package: rnaturalearth</code></pre>
<pre><code>## Loading required package: sf</code></pre>
<pre><code>## Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE</code></pre>
<pre><code>## Loading required package: terra</code></pre>
<pre><code>## terra 1.6.17</code></pre>
<pre><code>## 
## Attaching package: &#39;terra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<pre><code>## Error in dplyr::select(., database_id, decimalLatitude, decimalLongitude, : object &#39;check_pf&#39; not found</code></pre>
<p>Save the dataset</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;01_prefilter_database.csv&quot;</span>,</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="georefissue" class="section level2">
<h2>3.9 GeoRefIssue</h2>
<p>This function Identifies records whose coordinates can potentially be
extracted from locality information (must be manually checked
later).</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>xyFromLocality <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_coordinates_from_locality</span>(</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">locality =</span> <span class="st">&quot;locality&quot;</span>,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_outputs =</span> <span class="cn">TRUE</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
<p>Save data if needed.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>xyFromLocality <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;Output/Check/01_coordinates_from_locality.csv&quot;</span>,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;xyFromLocality&#39; not found</code></pre>
<p>Remove spent data</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(xyFromLocality)</span></code></pre></div>
</div>
<div id="flag-absent" class="section level2">
<h2>3.10 flag Absent</h2>
<p>Flag the records marked as “absent”</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_flagAbsent.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">jbd_flagAbsent</span>(<span class="at">data =</span> check_pf,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">PresAbs =</span> <span class="st">&quot;occurrenceStatus&quot;</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., .occurrenceAbsent = !.data[[PresAbs]] %in% c(&quot;ABSENT&quot;)): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="flag-license" class="section level2">
<h2>3.11 flag License</h2>
<p>Flag the records that may not be used according to their license
information</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_flagLicense.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">jbd_flagLicense</span>(<span class="at">data =</span> check_pf,</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">strings_to_restrict =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># DON&#39;T flag if in the following dataSource(s)</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">excludeDataSource =</span> <span class="fu">c</span>(<span class="st">&quot;KP_Anthophila&quot;</span>))</span></code></pre></div>
<pre><code>## Loading required package: rlang</code></pre>
<pre><code>## Error in dplyr::mutate(., .unLicensed = dplyr::if_else(grepl(paste(strings_to_restrict, : object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="gbif-issue" class="section level2">
<h2>3.12 GBIF issue</h2>
<p>Flag select issues that are flagged by GBIF</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_GBIFissues.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> <span class="fu">jbd_GBIFissues</span>(<span class="at">data =</span> check_pf, </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">issueColumn =</span> <span class="st">&quot;issue&quot;</span>, </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">GBIFflags =</span> <span class="fu">c</span>(<span class="st">&quot;COORDINATE_INVALID&quot;</span>, <span class="st">&quot;PRESUMED_NEGATED_LONGITUDE&quot;</span>, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;PRESUMED_NEGATED_LATITUDE&quot;</span>, </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;COUNTRY_COORDINATE_MISMATCH&quot;</span>, <span class="st">&quot;ZERO_COORDINATE&quot;</span>)) </span></code></pre></div>
<pre><code>## Error in jbd_GBIFissues(data = check_pf, issueColumn = &quot;issue&quot;, GBIFflags = c(&quot;COORDINATE_INVALID&quot;, : object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="flag-reports" class="section level2">
<h2>3.13 Flag Reports</h2>
<div id="a.-save-flags" class="section level3">
<h3>a. save flags</h3>
</div>
</div>
</div>
<div id="save-the-flags-so-far" class="section level1">
<h1>SAVE the flags so far</h1>
</div>
<div id="this-function-will-make-sure-that-you-keep-a-copy-of-everything-that-has-been-flagged-up-until-now." class="section level1">
<h1>This function will make sure that you keep a copy of everything that
has been flagged up until now.</h1>
</div>
<div id="this-will-be-updated-throughout-the-script-and-accessed-at-the-end-so-be-wary-of-moving-files-around-manually." class="section level1">
<h1>This will be updated throughout the script and accessed at the end,
so be wary of moving files around manually.</h1>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;flagRecorder.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>flagFile <span class="ot">&lt;-</span> <span class="fu">flagRecorder</span>(</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_pf,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># These are the columns that will be kept along with the flags</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">idColumns =</span> <span class="fu">c</span>(<span class="st">&quot;database_id&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># TRUE if you want to find a file from a previous part of the script to append to</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">findFile =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Error in flagRecorder(data = check_pf, path = DataPath, idColumns = c(&quot;database_id&quot;, : object &#39;check_pf&#39; not found</code></pre>
<p>produce summary column in main dataset</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_summary_col</span>(<span class="at">data =</span> check_pf)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_summary_col(data = check_pf): object &#39;check_pf&#39; not found</code></pre>
<p><mark>doesnt seem to be ‘b’ or is the summary column</mark></p>
<div id="c.-reporting" class="section level3">
<h3>c. reporting</h3>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>(report <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_create_report</span>(<span class="at">data =</span> check_pf,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">workflow_step =</span> <span class="st">&quot;prefilter&quot;</span>,</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">save_report =</span> <span class="cn">TRUE</span>)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Loading required package: DT</code></pre>
<pre><code>## Error in dplyr::select(., tidyselect::starts_with(&quot;.&quot;)): object &#39;check_pf&#39; not found</code></pre>
</div>
<div id="d.-figures" class="section level3">
<h3>d. figures</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>figures <span class="ot">&lt;-</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_create_figures</span>(<span class="at">data =</span> check_pf,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">workflow_step =</span> <span class="st">&quot;prefilter&quot;</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">save_figures =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Loading required package: cowplot</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lubridate&#39;:
## 
##     stamp</code></pre>
<pre><code>## Loading required package: rworldmap</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## ### Welcome to rworldmap ###</code></pre>
<pre><code>## For a short introduction type :   vignette(&#39;rworldmap&#39;)</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Loading required package: hexbin</code></pre>
<pre><code>## Error in dplyr::select(., tidyselect::starts_with(&quot;.&quot;)): object &#39;check_pf&#39; not found</code></pre>
<p>You can check figures using</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>figures<span class="sc">$</span>.coordinates_country_inconsistent</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;figures&#39; not found</code></pre>
</div>
<div id="save" class="section level2">
<h2>3.14 Save</h2>
<p>Save the intermediate dataset</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>check_pf <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(., <span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/01_prefilter_output.csv&quot;</span>,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_pf&#39; not found</code></pre>
<p>Remove spent dataset</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(check_pf)</span></code></pre></div>
</div>
</div>
<div id="taxonomy" class="section level1">
<h1>4.0 Taxonomy</h1>
</div>
<div id="see-bdc-tutorial-herehttpsbrunobrr.github.iobdcarticlestaxonomy.html." class="section level1">
<h1>See bdc tutorial (here)[<a href="https://brunobrr.github.io/bdc/articles/taxonomy.html" class="uri">https://brunobrr.github.io/bdc/articles/taxonomy.html</a>].<br />
</h1>
<p>Read in the filtered dataset</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>( <span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/01_prefilter_output.csv&quot;</span>,</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<p>Remove names_clean if it already exists (i.e. you have run this
before on this dataset)</p>
<pre><code>        database &lt;- database %&gt;%
          dplyr::select(!tidyselect::any_of(&quot;names_clean&quot;))</code></pre>
<div id="prep-data-names" class="section level2">
<h2>4.1 Prep data names</h2>
<p>This next step cleans the database’s scientificName column. The
cleaning tool will: - Flag and remove family names pre-pended to species
names - Flag and remove qualifiers denoting uncertain or provisional
status of taxonomic identification (e.g., confer, species, affinis, and
among others) - Flag and remove infraspecific terms (e.g., variety
[var.], subspecies [subsp], forma [f.], and their spelling variations) -
Standardize names, i.e., capitalize only the first letter of the genus
name and remove extra whitespaces) - Parse names, i.e., separate author,
date, annotations from taxon name.<br />
</p>
<p>***! MAC: You need to install gnparser through terminal — brew brew
tap gnames/gn brew install gnparser</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>parse_names <span class="ot">&lt;-</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_clean_names</span>(<span class="at">sci_names =</span> database<span class="sc">$</span>scientificName, <span class="at">save_outputs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## The latest gnparser version is v1.6.7</code></pre>
<pre><code>## Error in utils::download.file(grep(os, urls, value = TRUE), file, mode = &quot;wb&quot;): &#39;url&#39; must be a length-one character vector</code></pre>
<p>Keep only the .uncer_terms and names_clean columns</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>parse_names <span class="ot">&lt;-</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  parse_names <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.uncer_terms, names_clean)</span></code></pre></div>
<pre><code>## Error in dplyr::select(., .uncer_terms, names_clean): object &#39;parse_names&#39; not found</code></pre>
<p>Merge names with the complete dataset</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(database, parse_names)</span></code></pre></div>
<pre><code>## Error in list2(...): object &#39;database&#39; not found</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(parse_names)</span></code></pre></div>
</div>
<div id="taxo-harmonization" class="section level2">
<h2>4.2 Taxo harmonization</h2>
<p>Read in the custom taxonomy file.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>BeeTaxonomy <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste</span>(DiscLifePath, <span class="st">&quot;/Paige_DLdf_2022-07-29.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">col_types =</span> <span class="fu">c</span>(<span class="at">flags =</span> <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<p>Harmonise the names in the occurrence tibble</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;HarmonizeR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in file(filename, &quot;r&quot;, encoding = encoding): cannot open the connection</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   # This flags the occurrences without a matched name and matches names to their correct name </span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># according to DiscoverLife</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> <span class="fu">HarmoniseR</span>(<span class="at">path =</span> DataPath, <span class="co">#The path to a folder that the output can be saved</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SynList =</span> BeeTaxonomy, <span class="co"># The formatted taxonomy file</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">occurrences =</span> database)</span></code></pre></div>
<pre><code>## Error in HarmoniseR(path = DataPath, SynList = BeeTaxonomy, occurrences = database): could not find function &quot;HarmoniseR&quot;</code></pre>
<p>You don’t need this file anymore…</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(BeeTaxonomy)</span></code></pre></div>
<p>Save the harmonised file.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>database <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;02_taxonomy_database.csv&quot;</span>,</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;database&#39; not found</code></pre>
</div>
<div id="save-flags" class="section level2">
<h2>4.3 Save flags</h2>
<p>SAVE the flags so far.This will find the most-recent flag file and
append your new data to it. You can double-check the data and number of
columns if you’d like to be thorough and sure that all data are intact.
&lt;3</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;flagRecorder.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>flagFile <span class="ot">&lt;-</span> <span class="fu">flagRecorder</span>(</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> database,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">idColumns =</span> <span class="fu">c</span>(<span class="st">&quot;database_id&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">findFile =</span> <span class="cn">TRUE</span>,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">printSummary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in flagRecorder(data = database, path = DataPath, idColumns = c(&quot;database_id&quot;, : object &#39;database&#39; not found</code></pre>
</div>
</div>
<div id="space-the-final-frontier-or-deepspace-9-this-b" class="section level1">
<h1>5.0 Space: The final frontier or Deepspace 9 this B****</h1>
<p>Read in the last database</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output/Intermediate/02_taxonomy_database.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># It is likely that not all columns are present in this list and hence might </span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># throw a warning. Don&#39;t stress it.</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<div id="coord-precision" class="section level2">
<h2>5.1 Coord precision</h2>
<p>This function identifies records with a coordinate precision below a
specified number of decimal places. For example, the precision of a
coordinate with 1 decimal place is 11.132 km at the equator, i.e., the
scale of a large city. “Coordinates with one, two, or three decimal
places present a precision of ~11.1 km, ~1.1 km, and ~111 m at the
equator, respectively.”</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_coordinates_precision</span>(</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> database,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ndec =</span> <span class="dv">2</span> <span class="co"># number of decimals to be tested</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error in dplyr::select(., {: object &#39;database&#39; not found</code></pre>
<p>Remove the spent dataset</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(database)</span></code></pre></div>
<p>Save the harmonised file.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="sc">%&gt;%</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;03_space_inter_database.csv&quot;</span>,</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_space&#39; not found</code></pre>
</div>
<div id="common-spatial-issues" class="section level2">
<h2>5.2 Common spatial issues</h2>
<p>Only run for occurrences through clean_coordinates that are spatially
‘valid’. <strong>Not doing this might crash R</strong>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>tempSpace <span class="ot">&lt;-</span> check_space <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>.coordinates_empty <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>.coordinates_outOfRange <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::filter(., !.coordinates_empty == FALSE): object &#39;check_space&#39; not found</code></pre>
<p>Next, we will flag common spatial issues using functions of the
package CoordinateCleaner. It addresses some common issues in
biodiversity datasets (<mark>such as?</mark></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>tempSpace <span class="ot">&lt;-</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  CoordinateCleaner<span class="sc">::</span><span class="fu">clean_coordinates</span>(</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span>  tempSpace,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="st">&quot;scientificName&quot;</span>,</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">countries =</span> <span class="cn">NULL</span>, <span class="co"># Tests if coords are from x country. This is not needed.</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tests =</span> <span class="fu">c</span>(</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;capitals&quot;</span>,     <span class="co"># records within 0.5 km of capitals centroids</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;centroids&quot;</span>,    <span class="co"># records within 1 km around country and province centroids</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># &quot;duplicates&quot;,   # duplicated records</span></span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;equal&quot;</span>,      <span class="co"># records with equal coordinates</span></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;gbif&quot;</span>,         <span class="co"># records within 1 degree (~111km) of GBIF headsquare</span></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;institutions&quot;</span>, <span class="co"># records within 100m of zoo and herbaria</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># &quot;outliers&quot;, # outliers</span></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;zeros&quot;</span>,       <span class="co"># records with coordinates 0,0</span></span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># &quot;seas&quot;        # Not flagged as this should be flagged by coordinate country inconsistent</span></span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">capitals_rad =</span> <span class="dv">1000</span>,</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">centroids_rad =</span> <span class="dv">500</span>,</span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">centroids_detail =</span> <span class="st">&quot;both&quot;</span>, <span class="co"># test both country and province centroids</span></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_rad =</span> <span class="dv">100</span>, <span class="co"># remove zoo and herbaria within 100m</span></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># outliers_method = &quot;quantile&quot;,</span></span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># outliers_mtp = 5,</span></span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># outliers_td = 1000,</span></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># outliers_size = 10,</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_rad =</span> <span class="dv">0</span>,</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">zeros_rad =</span> <span class="fl">0.5</span>,</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">capitals_ref =</span> <span class="cn">NULL</span>,</span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">centroids_ref =</span> <span class="cn">NULL</span>,</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_ref =</span> <span class="cn">NULL</span>,</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_refcol =</span> <span class="st">&quot;countryCode&quot;</span>,</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_ref =</span> <span class="cn">NULL</span>,</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_ref =</span> <span class="cn">NULL</span>,</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># seas_scale = 50,</span></span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="st">&quot;spatialvalid&quot;</span> <span class="co"># result of tests are appended in separate columns</span></span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error in nams %in% names(x): object &#39;tempSpace&#39; not found</code></pre>
<p>re-merge the datasets</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span> tempSpace <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Re-bind with the records that were removed earlier</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(check_space <span class="sc">%&gt;%</span> </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">filter</span>(.coordinates_empty <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">|</span> </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>                                     .coordinates_outOfRange <span class="sc">==</span> <span class="cn">FALSE</span>) )</span></code></pre></div>
<pre><code>## Error in list2(...): object &#39;tempSpace&#39; not found</code></pre>
<p>Remove the temporary dataset</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tempSpace)</span></code></pre></div>
<p>Remove the flag summary columns</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span> check_space <span class="sc">%&gt;%</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&quot;summary&quot;</span>))</span></code></pre></div>
<pre><code>## Error in dplyr::select(., !contains(&quot;summary&quot;)): object &#39;check_space&#39; not found</code></pre>
<p>Save the intermediate dataset</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/03_space_inter_database.csv&quot;</span>,</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_space&#39; not found</code></pre>
</div>
<div id="diagonal-grid" class="section level2">
<h2>5.3 diagonal + grid</h2>
<p>Finds sequential numbers that could be fill-down errors in lat and
long, and groups by eventDate, recordedBy. This will only find those
where <em>ALL</em> records in a group are filled-down. Missing
occurrences will break the chain</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span> <span class="fu">jbd_diagonAlley</span>(</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_space,</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The minimum number of repeats needed to find a sequence in for flagging</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">minRepeats =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Error in jbd_diagonAlley(data = check_space, minRepeats = 4): could not find function &quot;jbd_diagonAlley&quot;</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/03_space_inter_database.csv&quot;</span>,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_space&#39; not found</code></pre>
<p>SPATIAL gridding from rasterisation: Select only the records with
more than X occurrences.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>griddingDF <span class="ot">&lt;-</span> check_space <span class="sc">%&gt;%</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude NA lat and lon values</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(<span class="fu">c</span>(<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by the dataset name</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(datasetName) <span class="sc">%&gt;%</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows that aren&#39;t unique for lat and long</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(decimalLongitude, decimalLatitude,</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the groups with 4 or more occurrence records </span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Error in tidyr::drop_na(., c(&quot;decimalLatitude&quot;, &quot;decimalLongitude&quot;)): object &#39;check_space&#39; not found</code></pre>
<p>Run the gridding analysis to find datasets that might be gridded.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>gridded_datasets <span class="ot">&lt;-</span> CoordinateCleaner<span class="sc">::</span><span class="fu">cd_round</span>(</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> griddingDF,</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ds =</span> <span class="st">&quot;datasetName&quot;</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">T1 =</span> <span class="dv">7</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_unique_ds_size =</span> <span class="dv">4</span>,</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="st">&quot;dataset&quot;</span>,</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">graphs =</span> <span class="cn">FALSE</span>,</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">reg_out_thresh =</span> <span class="dv">2</span>,</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">reg_dist_min =</span> <span class="fl">0.1</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">reg_dist_max =</span> <span class="dv">2</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>()</span></code></pre></div>
<pre><code>## Testing for rasterized collection</code></pre>
<pre><code>## Error in unique(x[[ds]]): object &#39;griddingDF&#39; not found</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The griddingDF is no longer needed. remove it.</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(griddingDF)</span></code></pre></div>
<p>Integrate these results with the main dataset</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span> check_space <span class="sc">%&gt;%</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join the datasets</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select the columns of interest</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(gridded_datasets, dataset, lon.flag, lat.flag, summary),</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;datasetName&quot;</span> <span class="ot">=</span> <span class="st">&quot;dataset&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make new columns with more-consistent naming and change the NA vlaues to = TRUE (not flagged)</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.lonFlag =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(lon.flag, <span class="cn">TRUE</span>),</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">.latFlag =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(lat.flag, <span class="cn">TRUE</span>),</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">.gridSummary =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(summary, <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove old columns</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(lon.flag, lat.flag, summary))</span></code></pre></div>
<pre><code>## Error in dplyr::left_join(., dplyr::select(gridded_datasets, dataset, : object &#39;check_space&#39; not found</code></pre>
<p>Save the gridded_datasets file for later examination</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>gridded_datasets <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/03_space_griddedDatasets.csv&quot;</span>,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;gridded_datasets&#39; not found</code></pre>
<p>Now remove this file</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gridded_datasets)</span></code></pre></div>
</div>
<div id="uncertainty" class="section level2">
<h2>5.4 Uncertainty</h2>
<p>Flag records that exceed a coordinateUncertaintyInMeters
threshold.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;coordUncerFlagR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>check_space <span class="ot">&lt;-</span> <span class="fu">coordUncerFlagR</span>(<span class="at">data =</span> check_space,</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">uncerColumn =</span> <span class="st">&quot;coordinateUncertaintyInMeters&quot;</span>,</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">threshold =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., .uncertaintyThreshold = !.data[[uncerColumn]] &gt; : object &#39;check_space&#39; not found</code></pre>
</div>
<div id="map-spatial-errors" class="section level2">
<h2>5.5 Map spatial errors</h2>
<p>Map ONE spatial flag at a time or map the .SUMMARY of all. Make this
selection in the col_to_map = section.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="sc">%&gt;%</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.summary <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co"># map only records flagged as FALSE</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_quickmap</span>(</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon =</span> <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="st">&quot;decimalLatitude&quot;</span>,</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_to_map =</span> <span class="st">&quot;.summary&quot;</span>,</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.9</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error in dplyr::filter(., .summary == FALSE): object &#39;check_space&#39; not found</code></pre>
</div>
<div id="space-report" class="section level2">
<h2>5.6 Space report</h2>
<p>Create the report</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>(report <span class="ot">&lt;-</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>   bdc<span class="sc">::</span><span class="fu">bdc_create_report</span>(</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(check_space <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>.uncer_terms)),</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">workflow_step =</span> <span class="st">&quot;space&quot;</span>,</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_report =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in dplyr::select(., !.uncer_terms): object &#39;check_space&#39; not found</code></pre>
</div>
<div id="space-figures" class="section level2">
<h2>5.7 Space figures</h2>
<p>Create figures of spacial data filtering.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_create_figures.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>(figures <span class="ot">&lt;-</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">jbd_create_figures</span>(</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(check_space <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>.uncer_terms)),</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">path =</span> DataPath,</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">workflow_step =</span> <span class="st">&quot;space&quot;</span>,</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_figures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in check_require_cran(&quot;cowplot&quot;): could not find function &quot;check_require_cran&quot;</code></pre>
<p>Check figure, options are: - .cap == Records around country capital
centroid<br />
- .cen == Records around country or province centroids - .dbl ==
Duplicated coordinates per species - .equ == Identical coordinates -
.otl == Geographical outliers - .gbf == Records around the GBIF
headquarters - .inst == Records around biodiversity institutions - .rou
== Rounded (probably imprecise) coordinates - .urb == Records within
urban areas — (Likely not relevant for bees.) / Example:</p>
<pre><code>        figures$.rou</code></pre>
<p>Save interim dataset</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>check_space <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Intermediate&quot;</span>, <span class="st">&quot;/03_space_inter_database.csv&quot;</span>,</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_space&#39; not found</code></pre>
</div>
<div id="save-flags-1" class="section level2">
<h2>5.8 Save flags</h2>
<p>SAVE the flags so far.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;flagRecorder.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">flagRecorder</span>(</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_space,</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">idColumns =</span> <span class="fu">c</span>(<span class="st">&quot;database_id&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">findFile =</span> <span class="cn">TRUE</span>,</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">printSummary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in flagRecorder(data = check_space, path = DataPath, idColumns = c(&quot;database_id&quot;, : object &#39;check_space&#39; not found</code></pre>
<p>BDC note: /</p>
<p>Filtering the database: “It is possible to remove flagged records
(potentially problematic ones) to get a ‘clean’ database (i.e., without
test columns starting with “.”). However, to ensure that all records
will be evaluated in all the data quality tests (i.e., tests of the
taxonomic, spatial, and temporal module of the package), potentially
erroneous or suspect records will be removed in the final module of the
package”. However, I have decided to run all occurrences through all
flags so that data can be filtered and examined accordingly. /</p>
<pre><code>        E.g. code:
        output &lt;- check_space
        # You can filter here if you want.
        #?     output &lt;-
        #?       check_space %&gt;%
        #?        # Dont filter out the uncertain term column.
        #?       dplyr::select(!.uncer_terms) %&gt;%
        #?        # Filter ALL where .summary = TRUE
        #?       dplyr::filter(.summary == TRUE) %&gt;%
        #?       bdc_filter_out_flags(data = ., col_to_remove = &quot;all&quot;)</code></pre>
<p>check_space is no longer needed and then remove it</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(check_space)</span></code></pre></div>
<p>For now, lets remove these columns to not mess up the Time step.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>   output <span class="ot">&lt;-</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>     check_space <span class="sc">%&gt;%</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">bdc_filter_out_flags</span>(<span class="at">data =</span> ., <span class="at">col_to_remove =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<pre><code>## Error in bdc_filter_out_flags(data = ., col_to_remove = &quot;all&quot;): could not find function &quot;bdc_filter_out_flags&quot;</code></pre>
</div>
<div id="save-1" class="section level2">
<h2>5.9 Save</h2>
<p>Save the intermediate dataset</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>output <span class="sc">%&gt;%</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;03_space_database.csv&quot;</span>,</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;output&#39; not found</code></pre>
<p>Remove the spent file</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(output)</span></code></pre></div>
</div>
</div>
<div id="time" class="section level1">
<h1>6.0 Time</h1>
<p>Read in the database again. <mark>You have Space and Time sections,
and not one Doctor Who reference!!…For shame</mark></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Output/Intermediate/03_space_database.csv&quot;</span>), </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># It is likely that not all columns are present in this list and hence might</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># throw a warning. Don&#39;t stress it.</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<p>You can plot a histogram of dates here, pre-cleaning to examine
potential issues.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lubridate<span class="sc">::</span><span class="fu">ymd_hms</span>(database<span class="sc">$</span>eventDate, <span class="at">truncated =</span> <span class="dv">5</span>), <span class="at">breaks =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;hist&#39;: object &#39;database&#39; not found</code></pre>
<p>Filter some silly dates that don’t make sense.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>database<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(database<span class="sc">$</span>year <span class="sc">&gt;</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>()) <span class="sc">|</span> database<span class="sc">$</span>year <span class="sc">&lt;</span> <span class="dv">1600</span>,</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cn">NA</span>, database<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## Error in ifelse(database$year &gt; lubridate::year(Sys.Date()) | database$year &lt; : object &#39;database&#39; not found</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>database<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(database<span class="sc">$</span>month <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">|</span> database<span class="sc">$</span>month <span class="sc">&lt;</span> <span class="dv">1</span>,</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">NA</span>, database<span class="sc">$</span>month)</span></code></pre></div>
<pre><code>## Error in ifelse(database$month &gt; 12 | database$month &lt; 1, NA, database$month): object &#39;database&#39; not found</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>database<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(database<span class="sc">$</span>day <span class="sc">&gt;</span> <span class="dv">31</span> <span class="sc">|</span> database<span class="sc">$</span>day <span class="sc">&lt;</span> <span class="dv">1</span>,</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">NA</span>, database<span class="sc">$</span>day)</span></code></pre></div>
<pre><code>## Error in ifelse(database$day &gt; 31 | database$day &lt; 1, NA, database$day): object &#39;database&#39; not found</code></pre>
<div id="recover-dates" class="section level2">
<h2>6.1 Recover dates</h2>
<p>RESCUE some records with poor date data if possible (e.g., from other
columns).</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;dateFindR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span> <span class="fu">dateFindR</span>(<span class="at">data =</span> database,</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Years above this are removed (from the recovered dates only)</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">maxYear =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>()),</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Years below this are removed (from the recovered dates only)</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">minYear =</span> <span class="dv">1700</span>)</span></code></pre></div>
<pre><code>##  — Preparing data...</code></pre>
<pre><code>## Error in dateFindR(data = database, maxYear = lubridate::year(Sys.Date()), : object &#39;database&#39; not found</code></pre>
<p>Remove the spent databse</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(database)</span></code></pre></div>
</div>
<div id="no-eventdate" class="section level2">
<h2>6.2 No eventDate</h2>
<p>Flag records that simply lack collection date :*()</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_eventDate_empty</span>(<span class="at">data =</span> check_time, <span class="at">eventDate =</span> <span class="st">&quot;eventDate&quot;</span>)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_eventDate_empty(data = check_time, eventDate = &quot;eventDate&quot;): object &#39;check_time&#39; not found</code></pre>
</div>
<div id="year-from-eventdate" class="section level2">
<h2>6.3 Year from eventDate</h2>
<p>See if bdc can extract the year from the eventDate column (this
should already be done by dateFindR).</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>check_time_year <span class="ot">&lt;-</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_year_from_eventDate</span>(<span class="at">data =</span> check_time, <span class="at">eventDate =</span> <span class="st">&quot;eventDate&quot;</span>)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_year_from_eventDate(data = check_time, eventDate = &quot;eventDate&quot;): object &#39;check_time&#39; not found</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">paste</span>(<span class="st">&quot; — If there is a difference in the number of years in each column this value will &quot;</span>,</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;not equal ZERO —— &quot;</span>,</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sum</span>(<span class="fu">complete.cases</span>(check_time<span class="sc">$</span>year)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">complete.cases</span>(check_time_year[,<span class="st">&quot;year&quot;</span>])),</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot; —— IF it is negative, then that value is the number of new year values.&quot;</span>,</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)) </span></code></pre></div>
<pre><code>## Error in complete.cases(check_time$year): object &#39;check_time&#39; not found</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Because this function makes TWO year columns, take only those rows that are NA in the original</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>check_time<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(check_time<span class="sc">$</span>year), </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># IF the year column in the dataset is empty, take the newly-created </span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># &quot;year&quot; columns from the bdc_year_from_eventDate dataset</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>                          check_time_year[,<span class="fu">ncol</span>(check_time_year)], </span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># If it is NOT empty, keep the original year.</span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>                          check_time<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## Error in ifelse(is.na(check_time$year), check_time_year[, ncol(check_time_year)], : object &#39;check_time&#39; not found</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(check_time_year)</span></code></pre></div>
</div>
<div id="old-records" class="section level2">
<h2>6.4 Old records</h2>
<p>This will flag records prior to the date selected. 1970 is frequently
chosen for SDM work. You may not need to fitler old records at all, so
think critically about your use.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  bdc<span class="sc">::</span><span class="fu">bdc_year_outOfRange</span>(<span class="at">data =</span> check_time,</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">eventDate =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">year_threshold =</span> <span class="dv">1970</span>)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_year_outOfRange(data = check_time, eventDate = &quot;year&quot;, : object &#39;check_time&#39; not found</code></pre>
</div>
<div id="time-report" class="section level2">
<h2>6.6 Time report</h2>
<p>Not all of it, just the time pertaining to our precise occurrence
records. Create a .summary column with all of the time flags where FALSE
== records that passed all filtering.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span> bdc<span class="sc">::</span><span class="fu">bdc_summary_col</span>(<span class="at">data =</span> check_time)</span></code></pre></div>
<pre><code>## Error in bdc::bdc_summary_col(data = check_time): object &#39;check_time&#39; not found</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>( report <span class="ot">&lt;-</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>    bdc<span class="sc">::</span><span class="fu">bdc_create_report</span>(<span class="at">data =</span> check_time,</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">workflow_step =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">save_report =</span> <span class="cn">FALSE</span>)</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>)  </span></code></pre></div>
<pre><code>## Error in dplyr::select(., tidyselect::starts_with(&quot;.&quot;)): object &#39;check_time&#39; not found</code></pre>
</div>
<div id="time-figures" class="section level2">
<h2>6.7 Time figures</h2>
<p>Create figures</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_create_figures.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>figures <span class="ot">&lt;-</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">jbd_create_figures</span>(<span class="at">data =</span> check_time,</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">path =</span> DataPath,</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">database_id =</span> <span class="st">&quot;database_id&quot;</span>,</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">workflow_step =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">save_figures =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in check_require_cran(&quot;cowplot&quot;): could not find function &quot;check_require_cran&quot;</code></pre>
<p>Check figures using</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>figures<span class="sc">$</span>year</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;figures&#39; not found</code></pre>
<p>Save the ~raw time dataset into the intermediate folder.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>check_time <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;04_time_database.csv&quot;</span>,</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;check_time&#39; not found</code></pre>
<p>Raw dataset can be re-read here # check_time &lt;- #
readr::read_csv(paste(DataPath, “Output”, “Intermediate”,
“04_time_database.csv”, # sep = “/”))</p>
</div>
<div id="save-flags-2" class="section level2">
<h2>6.8 Save flags</h2>
<p>SAVE the flags so far.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;flagRecorder.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">flagRecorder</span>(</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_time,</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">idColumns =</span> <span class="fu">c</span>(<span class="st">&quot;database_id&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;dataSource&quot;</span>),</span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">findFile =</span> <span class="cn">TRUE</span>,</span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">printSummary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in flagRecorder(data = check_time, path = DataPath, idColumns = c(&quot;database_id&quot;, : object &#39;check_time&#39; not found</code></pre>
</div>
</div>
<div id="de-duplication-2" class="section level1">
<h1>7.0 De-duplication 2?</h1>
<p><mark>an earlier section was de duplication 1 using the same
definitions. So add ‘2’ the title here?</mark></p>
<div id="deduplicate" class="section level2">
<h2>7.1 deDuplicate</h2>
<p>We will FLAG duplicates here. Duplicate flagging can be based on
“ID”: - user-specified — idColumns — This is done ITERATIVELY across
these columns Or based on collectInfoColumns. - This will use a set of
core columns - user-defined — collectionCols AND then with the above
columns, extra columns individually - user-defined — collectInfoColumns
— This is done ITERATIVELY across these columns</p>
<p>Find the most-recent deDuplication file</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a> prevRun <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath, <span class="at">fileName =</span> <span class="st">&quot;duplicateRun_ID_&quot;</span>)</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;duplicateRun_ID_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co">#These could be hacked to de-duplicate as you wish.</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;jbd_dupeSummary.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span> <span class="fu">jbd_dupeSummary</span>(</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> check_time,</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If you want to append a prior run&#39;s file, insert the file path here.</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">appendPath =</span> <span class="cn">NULL</span>,</span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Years ABOVE this will not be used to sort dateIdentified</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxYear =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>()),</span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Years BELOW this will not be used to sort dateIdentified</span></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">minYear =</span> <span class="dv">1700</span>,</span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># options are &quot;ID&quot;,&quot;collectionInfo&quot;, or &quot;both&quot;</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">duplicatedBy =</span> <span class="st">&quot;both&quot;</span>, <span class="co"># I&#39;m only running ID for the first lot because we might recover other info later</span></span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The columns to generate completeness info from</span></span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">completeness_cols =</span> <span class="fu">c</span>(<span class="st">&quot;decimalLatitude&quot;</span>,  <span class="st">&quot;decimalLongitude&quot;</span>,</span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;scientificName&quot;</span>, <span class="st">&quot;eventDate&quot;</span>),</span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">idColumns =</span> <span class="fu">c</span>(<span class="st">&quot;gbifID&quot;</span>, <span class="st">&quot;occurrenceID&quot;</span>, <span class="st">&quot;recordId&quot;</span>,<span class="st">&quot;id&quot;</span>),</span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The columns to ADDITIONALLY consider when finding duplicates in collectionInfo</span></span>
<span id="cb292-19"><a href="#cb292-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">collectionCols =</span> <span class="fu">c</span>(<span class="st">&quot;decimalLatitude&quot;</span>, <span class="st">&quot;decimalLongitude&quot;</span>, <span class="st">&quot;scientificName&quot;</span>, <span class="st">&quot;eventDate&quot;</span>, </span>
<span id="cb292-20"><a href="#cb292-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;recordedBy&quot;</span>),</span>
<span id="cb292-21"><a href="#cb292-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The columns to combine, one-by-one with the collectionCols</span></span>
<span id="cb292-22"><a href="#cb292-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">collectInfoColumns =</span> <span class="fu">c</span>(<span class="st">&quot;recordNumber&quot;</span>, <span class="st">&quot;eventID&quot;</span>, <span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;otherCatalogNumbers&quot;</span>,</span>
<span id="cb292-23"><a href="#cb292-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;collectionID&quot;</span>),</span>
<span id="cb292-24"><a href="#cb292-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom comparisons — as a list of </span></span>
<span id="cb292-25"><a href="#cb292-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">CustomComparisons =</span> tibble<span class="sc">::</span><span class="fu">lst</span>(<span class="fu">c</span>(<span class="st">&quot;catalogNumber&quot;</span>, <span class="st">&quot;institutionCode&quot;</span>)),</span>
<span id="cb292-26"><a href="#cb292-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The order in which you want to KEEP duplicated based on data source</span></span>
<span id="cb292-27"><a href="#cb292-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># try unique(check_time$dataSource)</span></span>
<span id="cb292-28"><a href="#cb292-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sourceOrder =</span> <span class="fu">c</span>(<span class="st">&quot;CAES&quot;</span>, <span class="st">&quot;Gai&quot;</span>, <span class="st">&quot;Ecd&quot;</span>,<span class="st">&quot;BMont&quot;</span>, <span class="st">&quot;BMin&quot;</span>, <span class="st">&quot;SFU&quot;</span>, <span class="st">&quot;ASP&quot;</span>, <span class="st">&quot;KP&quot;</span>, <span class="st">&quot;EcoS&quot;</span>, <span class="st">&quot;EaCo&quot;</span>,</span>
<span id="cb292-29"><a href="#cb292-29" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;USGS&quot;</span>, <span class="st">&quot;ALA&quot;</span>, <span class="st">&quot;INHS&quot;</span>, <span class="st">&quot;GBIF&quot;</span>,<span class="st">&quot;SCAN&quot;</span>,<span class="st">&quot;iDigBio&quot;</span>),</span>
<span id="cb292-30"><a href="#cb292-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># !!!!!! BELS &gt; GeoLocate</span></span>
<span id="cb292-31"><a href="#cb292-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To preference Paige&#39;s data over the RAW GBIF data, use the below</span></span>
<span id="cb292-32"><a href="#cb292-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">PaigeSort =</span> <span class="cn">TRUE</span>,</span>
<span id="cb292-33"><a href="#cb292-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To remove duplicates from CONSIDERATION once they are identified = TRUE, </span></span>
<span id="cb292-34"><a href="#cb292-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># or not = FALSE (by iteration)</span></span>
<span id="cb292-35"><a href="#cb292-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">consecutiveRemoval =</span> <span class="cn">FALSE</span></span>
<span id="cb292-36"><a href="#cb292-36" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="co"># </span><span class="re">END</span><span class="co"> jbd_dupeSummary</span></span>
<span id="cb292-37"><a href="#cb292-37" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in jbd_dupeSummary(data = check_time, path = DataPath, appendPath = NULL, : object &#39;check_time&#39; not found</code></pre>
</div>
</div>
<div id="data-filtering" class="section level1">
<h1>8.0 Data filtering</h1>
<div id="filter" class="section level2">
<h2>8.1 Filter</h2>
<p>Now clean the dataset of extra columns and failed rows.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>  check_time <span class="sc">%&gt;%</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which columns NOT to filter</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(.gridSummary, .lonFlag, .latFlag, .uncer_terms)) <span class="sc">%&gt;%</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update .summary column</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select all columns starting with &quot;.&quot;</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Delete the summary column if it&#39;s there</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>tidyselect<span class="sc">::</span><span class="fu">any_of</span>(<span class="st">&quot;.summary&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make FALSE == 1 and TRUE == 0</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.logical, <span class="sc">~</span><span class="fu">abs</span>(<span class="fu">as.numeric</span>(.) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IF rowSum &gt; 0 then there is at least one flag</span></span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rowSum =</span> <span class="fu">rowSums</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the .summary column</span></span>
<span id="cb294-15"><a href="#cb294-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.summaryNew =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(rowSum <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb294-16"><a href="#cb294-16" aria-hidden="true" tabindex="-1"></a>                                             <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-17"><a href="#cb294-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.summaryNew) <span class="sc">%&gt;%</span></span>
<span id="cb294-18"><a href="#cb294-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(check_time, .) <span class="sc">%&gt;%</span></span>
<span id="cb294-19"><a href="#cb294-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.summary =</span> .summaryNew) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>.summaryNew) <span class="sc">%&gt;%</span></span>
<span id="cb294-20"><a href="#cb294-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FILTER HERE</span></span>
<span id="cb294-21"><a href="#cb294-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(.summary <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb294-22"><a href="#cb294-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove filtering columns</span></span>
<span id="cb294-23"><a href="#cb294-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<pre><code>## Error in list2(...): object &#39;check_time&#39; not found</code></pre>
<p>Save this CLEANED dataset</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>output <span class="sc">%&gt;%</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">write_csv</span>(.,</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;05_cleaned_database.csv&quot;</span>,</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error in is.data.frame(x): object &#39;output&#39; not found</code></pre>
<p>Remove the spent dataset</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(check_time)</span></code></pre></div>
</div>
<div id="rm-outliers" class="section level2">
<h2>8.2 rm Outliers</h2>
<p>Remove outliers absed on manual identification of these records by
experts.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/Users/jamesdorey/Desktop/Uni/My_papers/Bee_SDM_paper/Data_acquisition_workflow/Paige_data/removedBecauseDeterminedOutlier.csv&quot;</span>,</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<p>Find outliers by occurrenceID</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>Outl_occID <span class="ot">&lt;-</span> check_time <span class="sc">%&gt;%</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(occurrenceID) <span class="sc">%&gt;%</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(occurrenceID <span class="sc">%in%</span> outliers<span class="sc">$</span>occurrenceID) </span></code></pre></div>
<pre><code>## Error in tidyr::drop_na(., occurrenceID): object &#39;check_time&#39; not found</code></pre>
<p>Find outliers by occurrenceID</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>Outliers_matched <span class="ot">&lt;-</span> check_time <span class="sc">%&gt;%</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove matched IDs</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>occurrenceID <span class="sc">%in%</span> Outl_occID<span class="sc">$</span>occurrenceID) <span class="sc">%&gt;%</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(catalogNumber) <span class="sc">%&gt;%</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(catalogNumber <span class="sc">%in%</span> outliers<span class="sc">$</span>catalogNumber) <span class="sc">%&gt;%</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Re-bind the outlier matches </span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(Outl_occID)</span></code></pre></div>
<pre><code>## Error in dplyr::filter(., !occurrenceID %in% Outl_occID$occurrenceID): object &#39;check_time&#39; not found</code></pre>
<p>Remove the outliers from the dataset</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span> check_time <span class="sc">%&gt;%</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>database_id <span class="sc">%in%</span> Outliers_matched<span class="sc">$</span>database_id)</span></code></pre></div>
<pre><code>## Error in dplyr::filter(., !database_id %in% Outliers_matched$database_id): object &#39;check_time&#39; not found</code></pre>
<p>Make a new .summary column</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>summaryCol <span class="ot">&lt;-</span> check_time <span class="sc">%&gt;%</span> </span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select all columns starting with &quot;.&quot;</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Delete the summary column if it&#39;s there</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.summary&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make FALSE == 1 and TRUE == 0</span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.logical, <span class="sc">~</span><span class="fu">abs</span>(<span class="fu">as.numeric</span>(.) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IF rowSum &gt; 0 then there is at least one flag</span></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rowSum =</span> <span class="fu">rowSums</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the .summary column</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.summary =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(rowSum <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.summary) </span></code></pre></div>
<pre><code>## Error in dplyr::select(., tidyselect::starts_with(&quot;.&quot;)): object &#39;check_time&#39; not found</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add this new column to the dataset in place of any other .summary column</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>check_time <span class="ot">&lt;-</span> check_time <span class="sc">%&gt;%</span> </span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Delete the summary column if it&#39;s there</span></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.summary&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the new summary column</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(summaryCol)</span></code></pre></div>
<pre><code>## Error in dplyr::select(., !tidyselect::starts_with(&quot;.summary&quot;)): object &#39;check_time&#39; not found</code></pre>
<p><mark>there doesn’t seem to be 8.3? is this the summary column ?
</mark></p>
</div>
<div id="save-uncleaned" class="section level2">
<h2>8.4 Save uncleaned</h2>
</div>
</div>
<div id="save-the-uncleaned-dataset" class="section level1">
<h1>Save the uncleaned dataset</h1>
<p>check_time %&gt;% readr::write_csv(., paste(DataPath, “Output”,
“Intermediate”, “05_unCleaned_database.csv”, sep = “/”))</p>
</div>
<div id="summary-figures" class="section level1">
<h1>9.0 Summary figures</h1>
<p>Read in the previously-cleaned dataset</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>beeData_clean <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>( <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;05_cleaned_database.csv&quot;</span>,</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
<p>Find the existing flag file and read it in</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>flagColumns <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath, <span class="at">fileName =</span> <span class="st">&quot;flagsRecorded_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;flagsRecorded_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<p>Read in the most-recent duplicate file</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Report&quot;</span>),</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fileName =</span> <span class="st">&quot;duplicateRun_both_2022-06-20.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code></pre></div>
<pre><code>## Error in file_finder(path = paste0(DataPath, &quot;/Output&quot;, &quot;/Report&quot;), fileName = &quot;duplicateRun_both_2022-06-20.csv&quot;): could not find function &quot;file_finder&quot;</code></pre>
<p>Add duplicates</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>flagColumns <span class="ot">&lt;-</span> flagColumns <span class="sc">%&gt;%</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.duplicate =</span> <span class="sc">!</span>flagColumns<span class="sc">$</span>database_id <span class="sc">%in%</span> duplicates<span class="sc">$</span>database_id)</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., .duplicate = !flagColumns$database_id %in% duplicates$database_id): object &#39;flagColumns&#39; not found</code></pre>
<div id="venn-diagrams" class="section level2">
<h2>9.1 Venn diagrams</h2>
<p>Create figures</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste</span>(ScriptPath, <span class="st">&quot;flagChartR.R&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">flagChartR</span>(</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flagColumns,</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># c(&quot;initial&quot;, &quot;taxonomy&quot;, &quot;space&quot;, &quot;time&quot;, &quot;all&quot;)</span></span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">flagType =</span> <span class="fu">c</span>(<span class="st">&quot;taxonomy&quot;</span>),</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> DataPath,</span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">largeVenns =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Loading required package: ggVennDiagram</code></pre>
<pre><code>## 
## Attaching package: &#39;ggVennDiagram&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:sp&#39;:
## 
##     Polygon</code></pre>
<pre><code>## Error in flagChartR(data = flagColumns, flagType = c(&quot;taxonomy&quot;), path = DataPath, : object &#39;flagColumns&#39; not found</code></pre>
</div>
<div id="chorddiagrams" class="section level2">
<h2>9.2 chordDiagrams</h2>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;circlize&quot;</span>)</span></code></pre></div>
<pre><code>## Installing package into &#39;C:/Users/ROaR8/AppData/Local/R/win-library/4.2&#39;
## (as &#39;lib&#39; is unspecified)</code></pre>
<pre><code>## Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;ComplexHeatmap&quot;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Bioconductor version 3.15 (BiocManager 1.30.18), R 4.2.1 (2022-06-23 ucrt)</code></pre>
<pre><code>## Installing package(s) &#39;ComplexHeatmap&#39;</code></pre>
<pre><code>## package &#39;ComplexHeatmap&#39; successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  C:\Users\ROaR8\AppData\Local\Temp\RtmpwThVLR\downloaded_packages</code></pre>
<pre><code>## Installation paths not writeable, unable to update packages
##   path: C:/Program Files/R/R-4.2.1/library
##   packages:
##     cluster, foreign, MASS, Matrix, nlme, nnet, survival</code></pre>
<pre><code>## Old packages: &#39;bibtex&#39;, &#39;classInt&#39;, &#39;cli&#39;, &#39;crayon&#39;, &#39;duckdb&#39;, &#39;ggforce&#39;,
##   &#39;openssl&#39;, &#39;raster&#39;, &#39;renv&#39;, &#39;rlang&#39;, &#39;taxadb&#39;, &#39;tinytex&#39;, &#39;vctrs&#39;, &#39;xfun&#39;</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the most-recent file</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath,</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fileName =</span> <span class="st">&quot;duplicateRun_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;duplicateRun_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<p>Create a table to go into chord diagram</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>chordData <span class="ot">&lt;-</span> <span class="fu">table</span>(dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(duplicates<span class="sc">$</span>dataSource, duplicates<span class="sc">$</span>dataSource_match)) </span></code></pre></div>
<pre><code>## Error in list2(...): object &#39;duplicates&#39; not found</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pdf</span>(<span class="at">file =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Output/Figures/&quot;</span>, <span class="st">&quot;ChordDiagram.pdf&quot;</span>),</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>  sourceNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALA_Apiformes&quot;</span>, <span class="st">&quot;iDigBio_apoidea&quot;</span>, <span class="st">&quot;USGS_data&quot;</span>,</span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;GBIF_Andrenidae&quot;</span>,<span class="st">&quot;GBIF_Apidae&quot;</span>,<span class="st">&quot;GBIF_Colletidae&quot;</span>,</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;GBIF_Halictidae&quot;</span>, <span class="st">&quot;GBIF_Megachilidae&quot;</span>,<span class="st">&quot;GBIF_Melittidae&quot;</span>,<span class="st">&quot;GBIF_Stenotritidae&quot;</span>,</span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SCAN_Andrenidae&quot;</span>,<span class="st">&quot;SCAN_Apidae&quot;</span>, <span class="st">&quot;SCAN_Colletidae&quot;</span> ,  </span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SCAN_Halictidae&quot;</span>,<span class="st">&quot;SCAN_Megachilidae&quot;</span>,<span class="st">&quot;SCAN_Melittidae&quot;</span>,<span class="st">&quot;SCAN_Stenotritidae&quot;</span>,</span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># OTHER</span></span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;CAES_Anthophila&quot;</span>, <span class="st">&quot;Gai_Anthophila&quot;</span>,</span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;ASP_Anthophila&quot;</span>, <span class="st">&quot;BMin_Anthophila&quot;</span>, <span class="st">&quot;BMont_Anthophila&quot;</span>,</span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Ecd_Anthophila&quot;</span>, <span class="st">&quot;INHS_Anthophila&quot;</span>)</span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a>  grid.col <span class="ot">=</span> <span class="fu">c</span>(<span class="at">ALA_Apiformes =</span> <span class="st">&quot;#807dba&quot;</span>, <span class="at">iDigBio_apoidea =</span> <span class="st">&quot;#4292c6&quot;</span>, <span class="at">USGS_data =</span> <span class="st">&quot;#636363&quot;</span>,</span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">GBIF_Andrenidae =</span> <span class="st">&quot;#feedde&quot;</span>, <span class="at">GBIF_Apidae =</span> <span class="st">&quot;#fdd0a2&quot;</span>, <span class="at">GBIF_Colletidae =</span> <span class="st">&quot;#fdae6b&quot;</span>,</span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">GBIF_Halictidae =</span> <span class="st">&quot;#fd8d3c&quot;</span>, <span class="at">GBIF_Megachilidae =</span> <span class="st">&quot;#f16913&quot;</span>, <span class="at">GBIF_Melittidae =</span> <span class="st">&quot;#d94801&quot;</span>, </span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">GBIF_Stenotritidae =</span> <span class="st">&quot;#8c2d04&quot;</span>,</span>
<span id="cb337-21"><a href="#cb337-21" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb337-22"><a href="#cb337-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">SCAN_Andrenidae =</span> <span class="st">&quot;#edf8fb&quot;</span>, <span class="at">SCAN_Apidae =</span> <span class="st">&quot;#ccece6&quot;</span>, <span class="at">SCAN_Colletidae =</span> <span class="st">&quot;#99d8c9&quot;</span>,</span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">SCAN_Halictidae =</span> <span class="st">&quot;#66c2a4&quot;</span>, <span class="at">SCAN_Megachilidae =</span> <span class="st">&quot;#41ae76&quot;</span>, <span class="at">SCAN_Melittidae =</span> <span class="st">&quot;#238b45&quot;</span>,</span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">SCAN_Stenotritidae =</span> <span class="st">&quot;#005824&quot;</span>,</span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a>               <span class="co"># OTHER</span></span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">CAES_Anthophila =</span> <span class="st">&quot;#7a0177&quot;</span>, <span class="at">INHS_Anthophila =</span> <span class="st">&quot;#ae017e&quot;</span>,</span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">Gai_Anthophila =</span> <span class="st">&quot;#dd3497&quot;</span>,</span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">ASP_Anthophila =</span> <span class="st">&quot;#f768a1&quot;</span>, <span class="at">BMin_Anthophila =</span> <span class="st">&quot;#fa9fb5&quot;</span>, </span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">BMont_Anthophila =</span> <span class="st">&quot;#fcc5c0&quot;</span>,</span>
<span id="cb337-30"><a href="#cb337-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">Ecd_Anthophila =</span> <span class="st">&quot;#feebe2&quot;</span>)</span>
<span id="cb337-31"><a href="#cb337-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-32"><a href="#cb337-32" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">circos.clear</span>()</span>
<span id="cb337-33"><a href="#cb337-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-34"><a href="#cb337-34" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">circos.par</span>(<span class="at">canvas.ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.0</span>,<span class="fl">1.0</span>), <span class="at">canvas.xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.25</span>))</span>
<span id="cb337-35"><a href="#cb337-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the chord diagrame</span></span>
<span id="cb337-36"><a href="#cb337-36" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">chordDiagram</span>(</span>
<span id="cb337-37"><a href="#cb337-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> chordData,</span>
<span id="cb337-38"><a href="#cb337-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> sourceNames,</span>
<span id="cb337-39"><a href="#cb337-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">directional =</span> <span class="dv">0</span>,</span>
<span id="cb337-40"><a href="#cb337-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduce =</span> <span class="dv">0</span>,</span>
<span id="cb337-41"><a href="#cb337-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid.col =</span> grid.col,</span>
<span id="cb337-42"><a href="#cb337-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">keep.diagonal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-43"><a href="#cb337-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># name, grid, axis</span></span>
<span id="cb337-44"><a href="#cb337-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotationTrack =</span> <span class="fu">c</span>(<span class="st">&quot;grid&quot;</span>),</span>
<span id="cb337-45"><a href="#cb337-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">preAllocateTracks =</span> <span class="fu">list</span>(</span>
<span id="cb337-46"><a href="#cb337-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">track.height =</span> circlize<span class="sc">::</span><span class="fu">mm_h</span>(<span class="dv">4</span>),</span>
<span id="cb337-47"><a href="#cb337-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">track.margin =</span> <span class="fu">c</span>(circlize<span class="sc">::</span><span class="fu">mm_h</span>(<span class="dv">1</span>), <span class="dv">0</span>)),</span>
<span id="cb337-48"><a href="#cb337-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb337-49"><a href="#cb337-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb337-50"><a href="#cb337-50" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">circos.trackPlotRegion</span>(<span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb337-51"><a href="#cb337-51" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xlim&quot;</span>)</span>
<span id="cb337-52"><a href="#cb337-52" aria-hidden="true" tabindex="-1"></a>    ylim <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ylim&quot;</span>)</span>
<span id="cb337-53"><a href="#cb337-53" aria-hidden="true" tabindex="-1"></a>    sector.name <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb337-54"><a href="#cb337-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># circlize::circos.text(mean(xlim), ylim[1] + 1.5, </span></span>
<span id="cb337-55"><a href="#cb337-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                       sector.name,</span></span>
<span id="cb337-56"><a href="#cb337-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                       facing = &quot;clockwise&quot;, niceFacing = TRUE, adj = c(0, 0),</span></span>
<span id="cb337-57"><a href="#cb337-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                       cex = 0.8)</span></span>
<span id="cb337-58"><a href="#cb337-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># circlize::circos.axis(h = &quot;top&quot;, labels.cex = 0.5, major.tick.length = 0.2, </span></span>
<span id="cb337-59"><a href="#cb337-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                       sector.index = sector.name, track.index = 2,</span></span>
<span id="cb337-60"><a href="#cb337-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                       labels.facing = &quot;reverse.clockwise&quot;, minor.ticks = 0)</span></span>
<span id="cb337-61"><a href="#cb337-61" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">bg.border =</span> <span class="cn">NA</span>)</span>
<span id="cb337-62"><a href="#cb337-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight inputs</span></span>
<span id="cb337-63"><a href="#cb337-63" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="st">&quot;iDigBio_apoidea&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#4292c6&quot;</span>, </span>
<span id="cb337-64"><a href="#cb337-64" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;iDigBio&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-65"><a href="#cb337-65" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="st">&quot;USGS_data&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#636363&quot;</span>, </span>
<span id="cb337-66"><a href="#cb337-66" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;USGS&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-67"><a href="#cb337-67" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="fu">c</span>( <span class="st">&quot;GBIF_Andrenidae&quot;</span>,<span class="st">&quot;GBIF_Apidae&quot;</span>,<span class="st">&quot;GBIF_Colletidae&quot;</span>,</span>
<span id="cb337-68"><a href="#cb337-68" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;GBIF_Halictidae&quot;</span>, <span class="st">&quot;GBIF_Megachilidae&quot;</span>,<span class="st">&quot;GBIF_Melittidae&quot;</span>,<span class="st">&quot;GBIF_Stenotritidae&quot;</span>),</span>
<span id="cb337-69"><a href="#cb337-69" aria-hidden="true" tabindex="-1"></a>                             <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#fd8d3c&quot;</span>, </span>
<span id="cb337-70"><a href="#cb337-70" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;GBIF&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-71"><a href="#cb337-71" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="fu">c</span>(<span class="st">&quot;SCAN_Andrenidae&quot;</span>,<span class="st">&quot;SCAN_Apidae&quot;</span>, <span class="st">&quot;SCAN_Colletidae&quot;</span> ,  </span>
<span id="cb337-72"><a href="#cb337-72" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;SCAN_Halictidae&quot;</span>,<span class="st">&quot;SCAN_Megachilidae&quot;</span>,<span class="st">&quot;SCAN_Melittidae&quot;</span>,<span class="st">&quot;SCAN_Stenotritidae&quot;</span>),</span>
<span id="cb337-73"><a href="#cb337-73" aria-hidden="true" tabindex="-1"></a>                             <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#66c2a4&quot;</span>, </span>
<span id="cb337-74"><a href="#cb337-74" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;SCAN&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-75"><a href="#cb337-75" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="st">&quot;ALA_Apiformes&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#807dba&quot;</span>, </span>
<span id="cb337-76"><a href="#cb337-76" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;ALA&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb337-77"><a href="#cb337-77" aria-hidden="true" tabindex="-1"></a>                             <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>)</span>
<span id="cb337-78"><a href="#cb337-78" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">highlight.sector</span>(<span class="fu">c</span>(<span class="st">&quot;CAES_Anthophila&quot;</span>, <span class="st">&quot;INHS_Anthophila&quot;</span>, <span class="st">&quot;Gai_Anthophila&quot;</span>,</span>
<span id="cb337-79"><a href="#cb337-79" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;ASP_Anthophila&quot;</span>, <span class="st">&quot;BMin_Anthophila&quot;</span>, <span class="st">&quot;BMont_Anthophila&quot;</span>,</span>
<span id="cb337-80"><a href="#cb337-80" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;Ecd_Anthophila&quot;</span>),</span>
<span id="cb337-81"><a href="#cb337-81" aria-hidden="true" tabindex="-1"></a>                             <span class="at">track.index =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;#f768a1&quot;</span>, </span>
<span id="cb337-82"><a href="#cb337-82" aria-hidden="true" tabindex="-1"></a>                             <span class="at">text =</span> <span class="st">&quot;Other&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">text.col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-83"><a href="#cb337-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-84"><a href="#cb337-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make legends</span></span>
<span id="cb337-85"><a href="#cb337-85" aria-hidden="true" tabindex="-1"></a>  lgd <span class="ot">=</span> ComplexHeatmap<span class="sc">::</span><span class="fu">Legend</span>(<span class="at">labels =</span> <span class="st">&quot;Anthophila&quot;</span>, <span class="at">title =</span> <span class="st">&quot;ALA&quot;</span>, <span class="at">legend_gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fill =</span> <span class="st">&quot;#807dba&quot;</span>))</span>
<span id="cb337-86"><a href="#cb337-86" aria-hidden="true" tabindex="-1"></a>  lgd2 <span class="ot">=</span> ComplexHeatmap<span class="sc">::</span><span class="fu">Legend</span>(<span class="at">labels =</span> <span class="st">&quot;Anthophila&quot;</span>, <span class="at">title =</span> <span class="st">&quot;iDigBio&quot;</span>, <span class="at">legend_gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fill =</span> <span class="st">&quot;#4292c6&quot;</span>))</span>
<span id="cb337-87"><a href="#cb337-87" aria-hidden="true" tabindex="-1"></a>  lgd3 <span class="ot">=</span> ComplexHeatmap<span class="sc">::</span><span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Andrenidae&quot;</span>,<span class="st">&quot;Apidae&quot;</span>,<span class="st">&quot;Colletidae&quot;</span>,</span>
<span id="cb337-88"><a href="#cb337-88" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Halictidae&quot;</span>, <span class="st">&quot;Megachilidae&quot;</span>,<span class="st">&quot;Melittidae&quot;</span>,<span class="st">&quot;Stenotritidae&quot;</span>),</span>
<span id="cb337-89"><a href="#cb337-89" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title =</span> <span class="st">&quot;GBIF&quot;</span>, <span class="at">legend_gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#feedde&quot;</span>, <span class="st">&quot;#fdd0a2&quot;</span>,<span class="st">&quot;#fdae6b&quot;</span>,</span>
<span id="cb337-90"><a href="#cb337-90" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="st">&quot;#fd8d3c&quot;</span>,<span class="st">&quot;#f16913&quot;</span>,<span class="st">&quot;#d94801&quot;</span>,</span>
<span id="cb337-91"><a href="#cb337-91" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="st">&quot;#8c2d04&quot;</span>)))</span>
<span id="cb337-92"><a href="#cb337-92" aria-hidden="true" tabindex="-1"></a>  lgd4 <span class="ot">=</span> ComplexHeatmap<span class="sc">::</span><span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Andrenidae&quot;</span>,<span class="st">&quot;Apidae&quot;</span>, <span class="st">&quot;Colletidae&quot;</span> ,  </span>
<span id="cb337-93"><a href="#cb337-93" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Halictidae&quot;</span>,<span class="st">&quot;Megachilidae&quot;</span>,<span class="st">&quot;Melittidae&quot;</span>,<span class="st">&quot;Stenotritidae&quot;</span>),</span>
<span id="cb337-94"><a href="#cb337-94" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title =</span> <span class="st">&quot;SCAN&quot;</span>, <span class="at">legend_gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#edf8fb&quot;</span>,<span class="st">&quot;#ccece6&quot;</span>,<span class="st">&quot;#99d8c9&quot;</span>,</span>
<span id="cb337-95"><a href="#cb337-95" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="st">&quot;#66c2a4&quot;</span>,<span class="st">&quot;#41ae76&quot;</span>,<span class="st">&quot;#238b45&quot;</span>,</span>
<span id="cb337-96"><a href="#cb337-96" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="st">&quot;#005824&quot;</span>)))</span>
<span id="cb337-97"><a href="#cb337-97" aria-hidden="true" tabindex="-1"></a>  lgd5 <span class="ot">=</span> ComplexHeatmap<span class="sc">::</span><span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;CAES_Anthophila&quot;</span>,<span class="st">&quot;INHS_Anthophila&quot;</span>, <span class="st">&quot;Gai_Anthophila&quot;</span>,</span>
<span id="cb337-98"><a href="#cb337-98" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;ASP_Anthophila&quot;</span>, <span class="st">&quot;BMin_Anthophila&quot;</span>, <span class="st">&quot;BMont_Anthophila&quot;</span>, </span>
<span id="cb337-99"><a href="#cb337-99" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Ecd_Anthophila&quot;</span>),</span>
<span id="cb337-100"><a href="#cb337-100" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title =</span> <span class="st">&quot;Other&quot;</span>, <span class="at">legend_gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#7a0177&quot;</span>,<span class="st">&quot;#ae017e&quot;</span>,</span>
<span id="cb337-101"><a href="#cb337-101" aria-hidden="true" tabindex="-1"></a>                                                                                 <span class="st">&quot;#dd3497&quot;</span>,<span class="st">&quot;#f768a1&quot;</span>,</span>
<span id="cb337-102"><a href="#cb337-102" aria-hidden="true" tabindex="-1"></a>                                                                                 <span class="st">&quot;#fa9fb5&quot;</span>,<span class="st">&quot;#fcc5c0&quot;</span>, <span class="st">&quot;#feebe2&quot;</span>)))</span>
<span id="cb337-103"><a href="#cb337-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-104"><a href="#cb337-104" aria-hidden="true" tabindex="-1"></a>  lgd_list <span class="ot">&lt;-</span> ComplexHeatmap<span class="sc">::</span><span class="fu">packLegend</span>(lgd, lgd2, lgd3, lgd4, lgd5)</span>
<span id="cb337-105"><a href="#cb337-105" aria-hidden="true" tabindex="-1"></a>  ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(lgd_list, <span class="at">x =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="dv">6</span>, <span class="st">&quot;mm&quot;</span>), </span>
<span id="cb337-106"><a href="#cb337-106" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="dv">18</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">just =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb337-107"><a href="#cb337-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-108"><a href="#cb337-108" aria-hidden="true" tabindex="-1"></a>  circlize<span class="sc">::</span><span class="fu">circos.clear</span>()</span>
<span id="cb337-109"><a href="#cb337-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-110"><a href="#cb337-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="st">&quot;Duplicated record sources&quot;</span>)</span>
<span id="cb337-111"><a href="#cb337-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb337-112"><a href="#cb337-112" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in pdf(file = paste0(DataPath, &quot;/Output/Figures/&quot;, &quot;ChordDiagram.pdf&quot;), : cannot open file &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Output/Figures/ChordDiagram.pdf&#39;</code></pre>
<p>Remove these data from the R space</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(chordData, grid.col, lgd, lgd_list, lgd2, lgd3, lgd4, lgd5)</span></code></pre></div>
<p>Save 7<em>6 <mark>the save 7</em>6 has no code? add or
delete</mark></p>
</div>
<div id="duplicate-plot" class="section level2">
<h2>9.3 Duplicate plot</h2>
<div id="a.-prep" class="section level3">
<h3>a. Prep</h3>
<div id="duplicates" class="section level4">
<h4>duplicates</h4>
<p>Read in the most-recent duplciates file</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath,</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fileName =</span> <span class="st">&quot;duplicateRun_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;duplicateRun_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<p>Read in the previously-cleaned dataset</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>beeData <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>( <span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;05_unCleaned_database.csv&quot;</span>,</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), <span class="at">col_types =</span> <span class="fu">ColTypeR</span>())</span></code></pre></div>
<pre><code>## Error in ColTypeR(): could not find function &quot;ColTypeR&quot;</code></pre>
</div>
<div id="flags" class="section level4">
<h4>FLAGS</h4>
<p>Find the existing flag file and read it in</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>flagColumns <span class="ot">&lt;-</span> <span class="fu">file_finder</span>(<span class="at">path =</span> DataPath, <span class="at">fileName =</span> <span class="st">&quot;flagsRecorded_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code></pre></div>
<pre><code>## Error in file_finder(path = DataPath, fileName = &quot;flagsRecorded_&quot;): could not find function &quot;file_finder&quot;</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>flagColumns<span class="sc">$</span>dataSource <span class="ot">&lt;-</span> flagColumns<span class="sc">$</span>dataSource <span class="sc">%&gt;%</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="at">replace =</span> <span class="st">&quot;iDigBio_apoidea&quot;</span>)</span></code></pre></div>
<pre><code>## Error in tidyr::replace_na(., replace = &quot;iDigBio_apoidea&quot;): object &#39;flagColumns&#39; not found</code></pre>
<p>Add duplicates</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>dupFig_tibble <span class="ot">&lt;-</span> flagColumns <span class="sc">%&gt;%</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new column that shows if the records HAVE a duplicate at all. (i.e., even the cleaned</span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># duplicate records)</span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">has_duplicate =</span> </span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">if_else</span>(</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>                    flagColumns<span class="sc">$</span>database_id <span class="sc">%in%</span> duplicates<span class="sc">$</span>database_id,</span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;Duplicate&quot;</span>,</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">if_else</span>(flagColumns<span class="sc">$</span>database_id <span class="sc">%in%</span> duplicates<span class="sc">$</span>database_id_match,</span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Kept duplicate&quot;</span>,</span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Unique&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select relevant columns</span></span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(database_id, has_duplicate, dataSource) <span class="sc">%&gt;%</span></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simplify the dataSources</span></span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">simpleSource =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(</span>
<span id="cb348-15"><a href="#cb348-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">string =</span> dataSource, <span class="at">pattern =</span> <span class="st">&quot;_.*&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., has_duplicate = dplyr::if_else(flagColumns$database_id %in% : object &#39;flagColumns&#39; not found</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the simpleSource to be consistent with elsewhere</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>dupFig_tibble<span class="sc">$</span>simpleSource <span class="ot">&lt;-</span> dupFig_tibble<span class="sc">$</span>simpleSource <span class="sc">%&gt;%</span> </span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">recode_factor</span>(</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">GBIF =</span> <span class="st">&quot;GBIF&quot;</span>, <span class="at">SCAN =</span> <span class="st">&quot;SCAN&quot;</span>, <span class="at">iDigBio =</span> <span class="st">&quot;iDigBio&quot;</span>, <span class="at">USGS =</span> <span class="st">&quot;USGS&quot;</span>, <span class="at">ALA =</span> <span class="st">&quot;ALA&quot;</span>, </span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ASP =</span> <span class="st">&quot;ASP&quot;</span>, <span class="at">INHS =</span> <span class="st">&quot;INHS&quot;</span>, <span class="at">CAES =</span> <span class="st">&quot;CAES&quot;</span>, <span class="at">BMont =</span> <span class="st">&quot;B. Mont.&quot;</span>, <span class="at">BMin =</span> <span class="st">&quot;B. Minkley&quot;</span>, <span class="at">Ecd =</span> <span class="st">&quot;Ecd&quot;</span>,</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gai =</span> <span class="st">&quot;Gaiarsa&quot;</span>, <span class="at">KP =</span> <span class="st">&quot;K. Parys&quot;</span>, <span class="at">SFU =</span> <span class="st">&quot;SFU&quot;</span>)</span></code></pre></div>
<pre><code>## Error in recode(.x, !!!values, .default = .default, .missing = .missing): object &#39;dupFig_tibble&#39; not found</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>(dupeBar <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(dupFig_tibble, </span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">aes</span>(simpleSource, <span class="at">fill =</span> has_duplicate)) <span class="sc">+</span></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;legend&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Duplicate&quot;</span> <span class="ot">=</span> <span class="st">&quot;#F2D2A2&quot;</span>,</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Kept duplicate&quot;</span> <span class="ot">=</span> <span class="st">&quot;#B9D6BC&quot;</span>,</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;Unique&quot;</span> <span class="ot">=</span> <span class="st">&quot;#349B90&quot;</span>)) <span class="sc">+</span></span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.line =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;Proportion of records&quot;</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;Data source&quot;</span>)</span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in ggplot2::ggplot(dupFig_tibble, ggplot2::aes(simpleSource, fill = has_duplicate)): object &#39;dupFig_tibble&#39; not found</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>(dupHist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dupFig_tibble, <span class="fu">aes</span>(simpleSource, <span class="at">fill =</span> has_duplicate)) <span class="sc">+</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;legend&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Duplicate&quot;</span> <span class="ot">=</span> <span class="st">&quot;#F2D2A2&quot;</span>,</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Kept duplicate&quot;</span> <span class="ot">=</span> <span class="st">&quot;#B9D6BC&quot;</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Unique&quot;</span> <span class="ot">=</span> <span class="st">&quot;#349B90&quot;</span>)) <span class="sc">+</span></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of records&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Data source&quot;</span>)</span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in ggplot(dupFig_tibble, aes(simpleSource, fill = has_duplicate)): object &#39;dupFig_tibble&#39; not found</code></pre>
<p>plot the figures together</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>(dupPlot <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(dupHist <span class="sc">+</span> </span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.8</span>),</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">legend.title =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>                               dupeBar, </span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">&#39;v&#39;</span>, <span class="at">axis =</span> <span class="st">&#39;l&#39;</span>))</span></code></pre></div>
<pre><code>## Error in cowplot::plot_grid(dupHist + theme(legend.position = c(0.85, : object &#39;dupHist&#39; not found</code></pre>
<p>Save the plot</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">save_plot</span>(<span class="at">filename =</span> </span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Output&quot;</span>, <span class="st">&quot;/Figures&quot;</span>, <span class="st">&quot;/duplicatePlot_2.pdf&quot;</span>),</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> dupPlot,</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">base_width =</span> <span class="dv">7</span>,</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">base_height =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## Error in plot_theme(plot): object &#39;dupPlot&#39; not found</code></pre>
</div>
</div>
</div>
<div id="database_id-figs" class="section level2">
<h2>9.4 database_id figs</h2>
<div id="a.-import-data" class="section level3">
<h3>a. Import data</h3>
<p>Use the uncleaned dataset</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>beeData <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;05_unCleaned_database.csv&quot;</span>,</span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error: &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Output/Intermediate/05_unCleaned_database.csv&#39; does not exist.</code></pre>
</div>
<div id="b.-prepare-data" class="section level3">
<h3>b. Prepare data</h3>
<p>Make a column with the dataSource without numbers</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>plotData <span class="ot">&lt;-</span> beeData <span class="sc">%&gt;%</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a new column with the dataSource names but not the specifics</span></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">database =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(dataSource,</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">pattern =</span> <span class="st">&quot;_.*&quot;</span>,</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by the new column (i.e. database)</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(database) <span class="sc">%&gt;%</span></span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only the filter columns (starting with &quot;.&quot;) and the database column</span></span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(database, tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(across(is.logical, ~as.numeric(.x))) %&gt;%</span></span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::filter(database %in% c(&quot;ASP&quot;, &quot;Ecd&quot;)) %&gt;%</span></span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot the data to a longer format for plotting in ggplot2.</span></span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;.&quot;</span>),</span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">&quot;flags&quot;</span>,</span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(database, flags, value) <span class="sc">%&gt;%</span></span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., database = stringr::str_replace(dataSource, : object &#39;beeData&#39; not found</code></pre>
<p>Make flag type</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>plotData<span class="sc">$</span>flagType <span class="ot">&lt;-</span> plotData<span class="sc">$</span>flags <span class="sc">%&gt;%</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">recode</span>(<span class="at">.coordinates_empty =</span> <span class="st">&quot;Initial&quot;</span>, <span class="at">.coordinates_outOfRange =</span> <span class="st">&quot;Initial&quot;</span>, </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">.basisOfRecords_notStandard =</span> <span class="st">&quot;Initial&quot;</span>, <span class="at">.coordinates_country_inconsistent =</span> <span class="st">&quot;Initial&quot;</span>,</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">.occurrenceAbsent =</span> <span class="st">&quot;Initial&quot;</span>, <span class="at">.unLicensed =</span> <span class="st">&quot;Initial&quot;</span>, <span class="at">jbd_GBIFissues =</span> <span class="st">&quot;Initial&quot;</span>,</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Taxonomy</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">.scientificName_empty =</span> <span class="st">&quot;Taxonomy&quot;</span>,<span class="at">.invalidName =</span> <span class="st">&quot;Taxonomy&quot;</span>, <span class="at">.uncer_terms =</span> <span class="st">&quot;Taxonomy&quot;</span>,</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>                <span class="co">#Space</span></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">.rou =</span> <span class="st">&quot;Space&quot;</span>,<span class="at">.cap =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.cen =</span> <span class="st">&quot;Space&quot;</span>,</span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">.equ =</span> <span class="st">&quot;Space&quot;</span>,<span class="at">.gbf =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.inst =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.zer =</span> <span class="st">&quot;Space&quot;</span>,<span class="at">.sea =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.val =</span> <span class="st">&quot;Space&quot;</span>,</span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">.sequential =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.lonFlag =</span> <span class="st">&quot;Space&quot;</span>, <span class="at">.latFlag =</span> <span class="st">&quot;Space&quot;</span>,<span class="at">.gridSummary =</span> <span class="st">&quot;Space&quot;</span>, </span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">.uncertaintyThreshold =</span> <span class="st">&quot;Space&quot;</span>,</span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Time</span></span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">.eventDate_empty =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">.year_outOfRange =</span> <span class="st">&quot;Time&quot;</span>, </span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Summary</span></span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">.duplicates =</span> <span class="st">&quot;Summary&quot;</span>, <span class="at">.summary =</span> <span class="st">&quot;Summary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>  forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(<span class="st">&quot;Initial&quot;</span>,<span class="st">&quot;Taxonomy&quot;</span>,<span class="st">&quot;Space&quot;</span>,<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Summary&quot;</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::recode(., .coordinates_empty = &quot;Initial&quot;, .coordinates_outOfRange = &quot;Initial&quot;, : object &#39;plotData&#39; not found</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can turn the flag columns into factors and order them here</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>plotData<span class="sc">$</span>flags <span class="ot">&lt;-</span> plotData<span class="sc">$</span>flags <span class="sc">%&gt;%</span></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">recode_factor</span>(<span class="at">.coordinates_empty =</span> <span class="st">&quot;No coordinates&quot;</span>, </span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.coordinates_outOfRange =</span> <span class="st">&quot;Point off map&quot;</span>, </span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.basisOfRecords_notStandard =</span> <span class="st">&quot;Excluded basis of record&quot;</span>, </span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.coordinates_country_inconsistent =</span> <span class="st">&quot;Coords. &amp; country inconsistent&quot;</span>,</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.occurrenceAbsent =</span> <span class="st">&quot;Absence record&quot;</span>, </span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.unLicensed =</span> <span class="st">&quot;Protected by license&quot;</span>, </span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">jbd_GBIFissues =</span> <span class="st">&quot;Flags by GBIF&quot;</span>,</span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Taxonomy</span></span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.scientificName_empty =</span> <span class="st">&quot;No scientific name&quot;</span>,</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.invalidName =</span> <span class="st">&quot;Name didn&#39;t match&quot;</span>, </span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.uncer_terms =</span> <span class="st">&quot;Taxonomy qualifier&quot;</span>,</span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#Space</span></span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.rou =</span> <span class="st">&quot;Coordinates rounded&quot;</span>,</span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.cap =</span> <span class="st">&quot;Capital centroid&quot;</span>, </span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.cen =</span> <span class="st">&quot;Country centroid&quot;</span>,</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.equ =</span> <span class="st">&quot;Coordinates equal&quot;</span>,</span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.gbf =</span> <span class="st">&quot;Point on GBIF HQ&quot;</span>, </span>
<span id="cb366-20"><a href="#cb366-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.inst =</span> <span class="st">&quot;Point on institution&quot;</span>, </span>
<span id="cb366-21"><a href="#cb366-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.zer =</span> <span class="st">&quot;Coordinates zero&quot;</span>,</span>
<span id="cb366-22"><a href="#cb366-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.sea =</span> <span class="st">&quot;Point in sea&quot;</span>, </span>
<span id="cb366-23"><a href="#cb366-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.val =</span> <span class="st">&quot;Coordinates invalid&quot;</span>,</span>
<span id="cb366-24"><a href="#cb366-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.sequential =</span> <span class="st">&quot;Coordinate fill-down&quot;</span>, </span>
<span id="cb366-25"><a href="#cb366-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.lonFlag =</span> <span class="st">&quot;Gridded longitudes&quot;</span>, <span class="at">.latFlag =</span> <span class="st">&quot;Gridded latituds&quot;</span>,</span>
<span id="cb366-26"><a href="#cb366-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.gridSummary =</span> <span class="st">&quot;Gridded lat &amp; lon&quot;</span>, </span>
<span id="cb366-27"><a href="#cb366-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.uncertaintyThreshold =</span> <span class="st">&quot;High coordinate uncertainty&quot;</span>,</span>
<span id="cb366-28"><a href="#cb366-28" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Time</span></span>
<span id="cb366-29"><a href="#cb366-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.eventDate_empty =</span> <span class="st">&quot;No event date&quot;</span>, <span class="at">.year_outOfRange =</span> <span class="st">&quot;Year out of range&quot;</span>, </span>
<span id="cb366-30"><a href="#cb366-30" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Summary</span></span>
<span id="cb366-31"><a href="#cb366-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.duplicates =</span> <span class="st">&quot;Duplicate&quot;</span>, <span class="at">.summary =</span> <span class="st">&quot;Summary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-32"><a href="#cb366-32" aria-hidden="true" tabindex="-1"></a>  forcats<span class="sc">::</span><span class="fu">fct_rev</span>() </span></code></pre></div>
<pre><code>## Error in recode(.x, !!!values, .default = .default, .missing = .missing): object &#39;plotData&#39; not found</code></pre>
<p>Factorise and order by database</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>plotData<span class="sc">$</span>database <span class="ot">&lt;-</span> plotData<span class="sc">$</span>database <span class="sc">%&gt;%</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">recode_factor</span>(</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">GBIF =</span> <span class="st">&quot;GBIF&quot;</span>, <span class="at">SCAN =</span> <span class="st">&quot;SCAN&quot;</span>, <span class="at">iDigBio =</span> <span class="st">&quot;iDigBio&quot;</span>, <span class="at">USGS =</span> <span class="st">&quot;USGS&quot;</span>, <span class="at">ALA =</span> <span class="st">&quot;ALA&quot;</span>, </span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ASP =</span> <span class="st">&quot;ASP&quot;</span>, <span class="at">INHS =</span> <span class="st">&quot;INHS&quot;</span>, <span class="at">CAES =</span> <span class="st">&quot;CAES&quot;</span>, <span class="at">BMont =</span> <span class="st">&quot;B. Mont.&quot;</span>, <span class="at">BMin =</span> <span class="st">&quot;B. Minkley&quot;</span>, <span class="at">Ecd =</span> <span class="st">&quot;Ecd&quot;</span>,</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gai =</span> <span class="st">&quot;Gaiarsa&quot;</span>, <span class="at">KP =</span> <span class="st">&quot;K. Parys&quot;</span>, <span class="at">SFU =</span> <span class="st">&quot;SFU&quot;</span>)</span></code></pre></div>
<pre><code>## Error in recode(.x, !!!values, .default = .default, .missing = .missing): object &#39;plotData&#39; not found</code></pre>
<p>Make plotData$value into a character type</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>plotData<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.character</span>(plotData<span class="sc">$</span>value)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;plotData&#39; not found</code></pre>
</div>
<div id="c.-plot" class="section level3">
<h3>c. Plot</h3>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> plotData) <span class="sc">+</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the plot facets</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( flagType<span class="sc">~</span>database, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">space=</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the bar plots</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> flags, <span class="at">x =</span> count, <span class="at">fill =</span> <span class="fu">as.factor</span>(value)), <span class="at">position=</span><span class="st">&quot;fill&quot;</span>, <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="sc">+</span></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Colour and label the plots</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;Pass&quot;</span>,</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;Fail&quot;</span>,</span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;NA&quot;</span> <span class="ot">=</span> <span class="st">&quot;NA&quot;</span>),</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;#127852&quot;</span>,</span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;#A7002D&quot;</span>,</span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;NA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#BDBABB&quot;</span>)) <span class="sc">+</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the theme stuff</span></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="co"># element_text(angle = 35, vjust = 0.5, hjust=0.5),</span></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text.y = element_text(colour = as.character(flagCols)),</span></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>))  <span class="sc">+</span> </span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span><span class="st">&quot;Proportion flagged&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Flag columns&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Filter&quot;</span>)</span></code></pre></div>
<pre><code>## Error in ggplot2::ggplot(data = plotData): object &#39;plotData&#39; not found</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="re">END</span><span class="co"> plot</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>plot</span></code></pre></div>
<pre><code>## standardGeneric for &quot;plot&quot; defined from package &quot;base&quot;
## 
## function (x, y, ...) 
## standardGeneric(&quot;plot&quot;)
## &lt;environment: 0x000001c58a1e65d0&gt;
## Methods may be defined for arguments: x, y
## Use  showMethods(plot)  for currently available ones.</code></pre>
<p>Save the figure</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;FlagsPlot.pdf&quot;</span>,</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">path =</span> <span class="fu">paste0</span>(DataPath, <span class="st">&quot;/Output/Figures&quot;</span>),</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot =</span> plot, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>,</span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span></code></pre></div>
<pre><code>## Error in grDevices::pdf(file = filename, ..., version = version): cannot open file &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Output/Figures/FlagsPlot.pdf&#39;</code></pre>
</div>
</div>
<div id="maps" class="section level2">
<h2>9.5 Maps</h2>
<div id="a.-data-prep" class="section level3">
<h3>a. Data prep</h3>
<p>Download world map using rnaturalearth packages</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>worldMap <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>, </span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">country =</span> <span class="cn">NULL</span>, <span class="at">type=</span><span class="st">&quot;map_units&quot;</span>)</span></code></pre></div>
<p>Import CLEANED dataset (you can change this option)</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>mapData <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste</span>(DataPath, <span class="st">&quot;Output&quot;</span>, <span class="st">&quot;Intermediate&quot;</span>, <span class="st">&quot;Angela_cleaned_database.csv&quot;</span>,</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## Error: &#39;D:/BeeDataCleaning2022/BeeDataCleaning/BeeDataCleaning/BeeData/Output/Intermediate/Angela_cleaned_database.csv&#39; does not exist.</code></pre>
<p>Make all of the US virgin islands species into US species</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>mapData<span class="sc">$</span>countryCode <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="at">string =</span> mapData<span class="sc">$</span>countryCode, </span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">pattern =</span> <span class="st">&quot;VI&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;US&quot;</span>)</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>Get the unique county<span class="sc">-</span>species pairs</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:3:5: unexpected symbol
## 2:                                             pattern = &quot;VI&quot;, replacement = &quot;US&quot;)
## 3: Get the
##        ^</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>mapData <span class="ot">&lt;-</span> mapData <span class="sc">%&gt;%</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(scientificName, countryCode, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Error in dplyr::distinct(., scientificName, countryCode, .keep_all = TRUE): object &#39;mapData&#39; not found</code></pre>
<p>Get a count of all of the species in each country</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>mapTable <span class="ot">&lt;-</span> <span class="fu">table</span>(mapData<span class="sc">$</span>countryCode) <span class="sc">%&gt;%</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="at">row.names =</span> <span class="cn">NULL</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">countryCode =</span> Var1, <span class="at">count =</span> Freq)</span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;as.data.frame&#39;: object &#39;mapData&#39; not found</code></pre>
<p>Join the map and occurrence data</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>fullMap <span class="ot">&lt;-</span>  <span class="fu">full_join</span>(worldMap,  mapTable,</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;iso_a2&quot;</span> <span class="ot">=</span> <span class="st">&quot;countryCode&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove na rows</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(count)</span></code></pre></div>
<pre><code>## Error in check_join(x, y): object &#39;mapTable&#39; not found</code></pre>
</div>
<div id="b.-breaks" class="section level3">
<h3>b. Breaks</h3>
<p>Make the class intervals. Class intervals from ?classIntervals:
fixed”, “sd”, “equal”, “pretty”, “quantile”,“kmeans”, “hclust”,
“bclust”, “fisher”, “jenks”, “dpih” or “headtails”.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>classes <span class="ot">&lt;-</span> classInt<span class="sc">::</span><span class="fu">classIntervals</span>(fullMap<span class="sc">$</span>count, <span class="at">n =</span> <span class="dv">15</span>, <span class="at">style =</span> <span class="st">&quot;jenks&quot;</span>, <span class="at">dig.lab=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## Error in is.factor(var): object &#39;fullMap&#39; not found</code></pre>
<p>Next we’ll create a new column in our sf object using the base R
cut() function to cut up our percent variable into distinct groups:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>fullMap <span class="ot">&lt;-</span> fullMap <span class="sc">%&gt;%</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">class_count =</span> <span class="fu">cut</span>(count, classes<span class="sc">$</span>brks, <span class="at">include.lowest =</span> T, <span class="at">dig.lab =</span> <span class="dv">10</span>))</span></code></pre></div>
<pre><code>## Error in dplyr::mutate(., class_count = cut(count, classes$brks, include.lowest = T, : object &#39;fullMap&#39; not found</code></pre>
</div>
<div id="c.-draw-map" class="section level3">
<h3>c. Draw map</h3>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>) <span class="co">#This stops an error.</span></span></code></pre></div>
<pre><code>## Spherical geometry (s2) switched off</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the map</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>(countryMap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fullMap, ) <span class="sc">+</span></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot and colour the terrestrial base map</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> class_count), <span class="at">size =</span> <span class="fl">0.15</span>)<span class="sc">+</span> </span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set map limits, if wanted</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">60</span>,<span class="dv">90</span>), <span class="at">lims_method =</span> <span class="st">&quot;geometry_bbox&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map formatting</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add in the map&#39;s north arrow</span></span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tl&quot;</span>, <span class="at">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">style =</span> north_arrow_fancy_orienteering) <span class="sc">+</span> <span class="co"># Add in NORTH ARROW</span></span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">gray</span>(.<span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>), </span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Add grid lines</span></span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="fu">gray</span>(.<span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">1</span>), </span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb395-16"><a href="#cb395-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> <span class="cn">NA</span>), <span class="co"># add panel border</span></span>
<span id="cb395-17"><a href="#cb395-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;aliceblue&quot;</span>) )<span class="sc">+</span> <span class="co"># Add background — colour in the ocean</span></span>
<span id="cb395-18"><a href="#cb395-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Change map colour scheme — CHOOSE YOUR OWN ADVENTURE</span></span>
<span id="cb395-19"><a href="#cb395-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>,</span>
<span id="cb395-20"><a href="#cb395-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.value =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span> <span class="co"># options = &quot;magma&quot;, &quot;inferno&quot;, &quot;plasma&quot;, &quot;cividis&quot;</span></span>
<span id="cb395-21"><a href="#cb395-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add in X and Y labels</span></span>
<span id="cb395-22"><a href="#cb395-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span> </span>
<span id="cb395-23"><a href="#cb395-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add in the title</span></span>
<span id="cb395-24"><a href="#cb395-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>( <span class="st">&quot;Number of species per country&quot;</span>)  )</span></code></pre></div>
<pre><code>## Error in ggplot(data = fullMap, ): object &#39;fullMap&#39; not found</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>Save as the map as <span class="dv">10</span><span class="sc">*</span><span class="dv">6</span><span class="st">&quot;</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="st">ggplot2::ggsave( &quot;</span>spPerCountry_jenks.pdf<span class="st">&quot;, plot = countryMap, device = &quot;</span>pdf<span class="st">&quot;, </span></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 width = 10, height = 5, dpi = 300, </span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a><span class="st">                 path = paste0(DataPath, &quot;</span><span class="sc">/</span>Output<span class="sc">/</span>Figures<span class="st">&quot;))</span></span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:1:6: unexpected symbol
## 1: Save as
##          ^</code></pre>
</div>
</div>
</div>
<div id="fin" class="section level1">
<h1>FIN</h1>
</div>
</section>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
