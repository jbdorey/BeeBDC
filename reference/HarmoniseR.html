<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-gb"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Harmonise taxonomy of occurrence data — harmoniseR • BeeBDC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Harmonise taxonomy of occurrence data — harmoniseR"><meta name="description" content="Uses BeeBDC-formatted taxonomy data to harmonise occurrence records and flag those that do not match
the taxonomy harmoniseR() prefers to use the names_clean columns that is generated
by bdc::bdc_clean_names(). While this is not required, you may find better results by running
that function on your dataset first.
It is possible to download taxonomy file for other taxa using taxadbToBeeBDC()
which can download taxonomies from ITIS, GBIF, and more. You could also match the format of the
beesTaxonomy() file."><meta property="og:description" content="Uses BeeBDC-formatted taxonomy data to harmonise occurrence records and flag those that do not match
the taxonomy harmoniseR() prefers to use the names_clean columns that is generated
by bdc::bdc_clean_names(). While this is not required, you may find better results by running
that function on your dataset first.
It is possible to download taxonomy file for other taxa using taxadbToBeeBDC()
which can download taxonomies from ITIS, GBIF, and more. You could also match the format of the
beesTaxonomy() file."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BeeBDC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to package home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Function list"><span class="fa fas fa-r"></span> Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-occurrence-cleaning" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Occurrence data cleaning vignettes"><span class="fa fas fa-broom"></span> Occurrence cleaning</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-occurrence-cleaning"><li><a class="dropdown-item" href="../articles/BeeBDC_main.html">BeeBDC full cleaning workflow</a></li>
    <li><a class="dropdown-item" href="../articles/basic_workflow.html">BeeBDC basic workflow</a></li>
    <li><a class="dropdown-item" href="../articles/dataPrep.html">Bee-specific data preparation</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-species-richness-estimation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Species richness estimation vignettes"><span class="fa fas fa-arrow-up-right-dots"></span> Species richness estimation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-species-richness-estimation"><li><a class="dropdown-item" href="../articles/speciesRichness_example.html">BeeBDC richness estimation</a></li>
    <li><a class="dropdown-item" href="../articles/speciesRichness_example.html#Parallel-estimations">  1.0 Parallel estimation</a></li>
    <li><a class="dropdown-item" href="../articles/speciesRichness_example.html#Estimating-richness-from-the-known-unknowns">  2.0 Estimation with checklists</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="https://jbdorey.github.io/BeeBDC/news/index.html"><span class="fa fas fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbdorey/BeeBDC/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Harmonise taxonomy of occurrence data</h1>
      <small class="dont-index">Source: <a href="https://github.com/jbdorey/BeeBDC/blob/devel/R/HarmoniseR.R" class="external-link"><code>R/HarmoniseR.R</code></a></small>
      <div class="d-none name"><code>HarmoniseR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses BeeBDC-formatted taxonomy data to harmonise occurrence records and flag those that do not match
the taxonomy <code>harmoniseR()</code> prefers to use the names_clean columns that is generated
by <code><a href="https://brunobrr.github.io/bdc/reference/bdc_clean_names.html" class="external-link">bdc::bdc_clean_names()</a></code>. While this is not required, you may find better results by running
that function on your dataset first.
It is possible to download taxonomy file for other taxa using <code><a href="taxadbToBeeBDC.html">taxadbToBeeBDC()</a></code>
which can download taxonomies from ITIS, GBIF, and more. You could also match the format of the
<code><a href="beesTaxonomy.html">beesTaxonomy()</a></code> file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">harmoniseR</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taxonomy <span class="op">=</span> <span class="fu">BeeBDC</span><span class="fu">::</span><span class="fu"><a href="beesTaxonomy.html">beesTaxonomy</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  speciesColumn <span class="op">=</span> <span class="st">"scientificName"</span>,</span>
<span>  rm_names_clean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkVerbatim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stepSize <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble. Occurrence records as input.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>A directory as character. The path to a folder that the output can be saved.</p></dd>


<dt id="arg-taxonomy">taxonomy<a class="anchor" aria-label="anchor" href="#arg-taxonomy"></a></dt>
<dd><p>A data frame or tibble. The taxonomy file to use.
Default = <code><a href="beesTaxonomy.html">beesTaxonomy()</a></code>; for other taxa see first <code><a href="taxadbToBeeBDC.html">taxadbToBeeBDC()</a></code>.</p></dd>


<dt id="arg-speciescolumn">speciesColumn<a class="anchor" aria-label="anchor" href="#arg-speciescolumn"></a></dt>
<dd><p>Character. The name of the column containing species names. Default = "scientificName".</p></dd>


<dt id="arg-rm-names-clean">rm_names_clean<a class="anchor" aria-label="anchor" href="#arg-rm-names-clean"></a></dt>
<dd><p>Logical. If TRUE then the names_clean column will be removed at the end of
this function to help reduce confusion about this column later. Default = TRUE</p></dd>


<dt id="arg-checkverbatim">checkVerbatim<a class="anchor" aria-label="anchor" href="#arg-checkverbatim"></a></dt>
<dd><p>Logical. If TRUE then the verbatimScientificName will be checked as well
for species matches. This matching will ONLY be done after harmoniseR has failed for the other
name columns. NOTE: this column is <em>not</em> first run through <code><a href="https://brunobrr.github.io/bdc/reference/bdc_clean_names.html" class="external-link">bdc::bdc_clean_names</a></code>. Default = FALSE</p></dd>


<dt id="arg-stepsize">stepSize<a class="anchor" aria-label="anchor" href="#arg-stepsize"></a></dt>
<dd><p>Numeric. The number of occurrences to process in each chunk. Default = 1000000.</p></dd>


<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>Numeric. If &gt; 1, the function will run in parallel
using mclapply using the number of cores specified. If = 1 then it will be run using a serial
loop. NOTE: Windows machines must use a value of 1 (see ?parallel::mclapply). Additionally,
be aware that each thread can use large chunks of memory.
Default = 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The occurrences are returned with update taxonomy columns, including: scientificName,
species, family, subfamily, genus, subgenus, specificEpithet, infraspecificEpithet, and
scientificNameAuthorship. A new column, .invalidName, is also added and is FALSE when the occurrence's
name did not match the supplied taxonomy.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="taxadbToBeeBDC.html">taxadbToBeeBDC()</a></code> to download any taxonomy (of any taxa or of bees) and
<code><a href="beesTaxonomy.html">beesTaxonomy()</a></code> for the bee taxonomy download.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load in the test dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testTaxonomy.rda"</span>, package<span class="op">=</span><span class="st">"BeeBDC"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See also</span></span></span>
<span class="r-in"><span><span class="op">?</span><span class="fu">BeeBDC</span><span class="fu">::</span><span class="fu"><a href="taxadbToBeeBDC.html">taxadbToBeeBDC</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">beesRaw_out</span> <span class="op">&lt;-</span> <span class="fu">BeeBDC</span><span class="fu">::</span><span class="fu">harmoniseR</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co">#The path to a folder that the output can be saved</span></span></span>
<span class="r-in"><span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="co"># The formatted taxonomy file</span></span></span>
<span class="r-in"><span>taxonomy <span class="op">=</span> <span class="va">testTaxonomy</span>, </span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="fu">BeeBDC</span><span class="fu">::</span><span class="va"><a href="beesFlagged.html">beesFlagged</a></span>,</span></span>
<span class="r-in"><span>speciesColumn <span class="op">=</span> <span class="st">"scientificName"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Formatting taxonomy for matching...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Harmonise the occurrence data with unambiguous names...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Attempting to harmonise the occurrence data with ambiguous names...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Formatting merged datasets...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing the names_clean column...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - We matched valid names to 96 of 100 occurrence records. This leaves a total of 4 unmatched occurrence records.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> harmoniseR:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> records were flagged.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The column, '.invalidName' was added to the database.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - We updated the following columns: scientificName, species, family, subfamily, genus, subgenus, specificEpithet, infraspecificEpithet, and scientificNameAuthorship. The previous scientificName column was converted to verbatimScientificName</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Completed in 0.2 secs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">beesRaw_out</span><span class="op">$</span><span class="va">.invalidName</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE  TRUE  &lt;NA&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4    96     0 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James B. Dorey, Robert L. O’Reilly, Silas Bossert, Erica E. Fischer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

