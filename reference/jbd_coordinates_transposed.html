<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-gb"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify transposed geographic coordinates — jbd_coordinates_transposed • BeeBDC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify transposed geographic coordinates — jbd_coordinates_transposed"><meta name="description" content="This function flags and corrects records when latitude and longitude appear
to be transposed.
This function will preferably use the countryCode column generated by
bdc::bdc_country_standardized()."><meta property="og:description" content="This function flags and corrects records when latitude and longitude appear
to be transposed.
This function will preferably use the countryCode column generated by
bdc::bdc_country_standardized()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BeeBDC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to package home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html" aria-label="Function list"><span class="fa fas fa-r"></span> Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-occurrence-cleaning" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Occurrence data cleaning vignettes"><span class="fa fas fa-broom"></span> Occurrence cleaning</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-occurrence-cleaning"><li><a class="dropdown-item" href="../articles/BeeBDC_main.html">BeeBDC cleaning sections</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#data-merge">  1.0 Data merge</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#data-preparation">  2.0 Data preparation</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#initial-flags">  3.0 Initial flags</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#taxonomy">  4.0 Taxonomy</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#space">  5.0 Space</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#time">  6.0 Time</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#de-duplication">  7.0 De-duplication</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#data-filtering">  8.0 Data filtering</a></li>
    <li><a class="dropdown-item" href="../articles/BeeBDC_main.html#figures-and-tables">  9.0 Figures and tables</a></li>
    <li><a class="dropdown-item" href="../articles/basic_workflow.html">BeeBDC basic workflow</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-species-richness-estimation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Species richness estimation vignettes"><span class="fa fas fa-arrow-up-right-dots"></span> Species richness estimation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-species-richness-estimation"><li><a class="dropdown-item" href="../articles/speciesRichness_example.html">BeeBDC richness estimation</a></li>
    <li><a class="dropdown-item" href="../articles/speciesRichness_example.html#Parallel-estimations">  1.0 Parallel estimation</a></li>
    <li><a class="dropdown-item" href="../articles/speciesRichness_example.html#Estimating-richness-from-the-known-unknowns">  2.0 Estimation with checklists</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="https://jbdorey.github.io/BeeBDC/news/index.html"><span class="fa fas fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbdorey/BeeBDC/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identify transposed geographic coordinates</h1>
      <small class="dont-index">Source: <a href="https://github.com/jbdorey/BeeBDC/blob/devel/R/jbd_coordinates_transposed.R" class="external-link"><code>R/jbd_coordinates_transposed.R</code></a></small>
      <div class="d-none name"><code>jbd_coordinates_transposed.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function flags and corrects records when latitude and longitude appear
to be transposed.
This function will preferably use the countryCode column generated by
<code><a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc::bdc_country_standardized()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jbd_coordinates_transposed</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  idcol <span class="op">=</span> <span class="st">"database_id"</span>,</span>
<span>  sci_names <span class="op">=</span> <span class="st">"scientificName"</span>,</span>
<span>  lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>  lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>  countryCode <span class="op">=</span> <span class="st">"countryCode"</span>,</span>
<span>  border_buffer <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  save_outputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fileName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"large"</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble. Containing a unique identifier for each record,
geographical coordinates, and country names. Coordinates must be expressed
in decimal degrees and WGS84.</p></dd>


<dt id="arg-idcol">idcol<a class="anchor" aria-label="anchor" href="#arg-idcol"></a></dt>
<dd><p>A character string. The column name with a unique record identifier.
Default = "database_id".</p></dd>


<dt id="arg-sci-names">sci_names<a class="anchor" aria-label="anchor" href="#arg-sci-names"></a></dt>
<dd><p>A character string. The column name with species' scientific
names. Default = "scientificName".</p></dd>


<dt id="arg-lat">lat<a class="anchor" aria-label="anchor" href="#arg-lat"></a></dt>
<dd><p>A character string. The column name with latitudes. Coordinates must
be expressed in decimal degrees and WGS84. Default = "decimalLatitude".</p></dd>


<dt id="arg-lon">lon<a class="anchor" aria-label="anchor" href="#arg-lon"></a></dt>
<dd><p>A character string. The column name with longitudes. Coordinates must be
expressed in decimal degrees and WGS84. Default = "decimalLongitude".</p></dd>


<dt id="arg-country">country<a class="anchor" aria-label="anchor" href="#arg-country"></a></dt>
<dd><p>A character string. The column name with the country
assignment of each occurrence record. Default = "country".</p></dd>


<dt id="arg-countrycode">countryCode<a class="anchor" aria-label="anchor" href="#arg-countrycode"></a></dt>
<dd><p>A character string. The column name containing an ISO-2 country code for
each record.</p></dd>


<dt id="arg-border-buffer">border_buffer<a class="anchor" aria-label="anchor" href="#arg-border-buffer"></a></dt>
<dd><p>Numeric. Must have value greater than or equal to 0.
A distance in decimal degrees used to
created a buffer around each country. Records within a given country and at
a specified distance from the border will be not be corrected.
Default = 0.2 (~22 km at the equator).</p></dd>


<dt id="arg-save-outputs">save_outputs<a class="anchor" aria-label="anchor" href="#arg-save-outputs"></a></dt>
<dd><p>Logical. Indicates if a table containing transposed coordinates should be
saved for further inspection. Default = FALSE.</p></dd>


<dt id="arg-filename">fileName<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>A character string. The out file's name.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Passed to rnaturalearth's ne_countries().
Scale of map to return, one of 110, 50, 10 or 'small', 'medium', 'large'. Default = "large".</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>A character string. A path as a character vector for where to create the directories
and save the figures. If
no path is provided (the default), the directories will be created using <code><a href="https://here.r-lib.org/reference/here.html" class="external-link">here::here()</a></code>.</p></dd>


<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>Numeric. If &gt; 1, the jbd_correct_coordinates function will run in parallel
using mclapply using the number of cores specified. If = 1 then it will be run using a serial
loop. NOTE: Windows machines must use a value of 1 (see ?parallel::mclapply). Additionally,
be aware that each thread can use large chunks of memory.
Default = 1.#'</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing the column "coordinates_transposed" which indicates if
verbatim coordinates were not transposed (TRUE). Otherwise
records are flagged as (FALSE) and, in this case, verbatim coordinates are
replaced by corrected coordinates.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This test identifies transposed coordinates based on mismatches between the
country provided for a record and the record’s latitude and longitude coordinates. Transposed
coordinates often fall outside of the indicated country (i.e., in other
countries or in the sea). Different coordinate transformations are
performed to correct country/coordinates mismatches. Importantly, verbatim
coordinates are replaced by the corrected ones in the returned database. A
database containing verbatim and corrected coordinates is created in
"Output/Check/01_coordinates_transposed.csv" if save_outputs == TRUE. The
columns "country" and "countryCode" can be retrieved by using the function
<a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc::bdc_country_standardized</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">database_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scientificName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Rhinella major"</span>, <span class="st">"Scinax ruber"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Siparuna guianensis"</span>, <span class="st">"Psychotria vellosiana"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decimalLatitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">63.43333</span>, <span class="op">-</span><span class="fl">14.43333</span>, <span class="op">-</span><span class="fl">41.90000</span>, <span class="op">-</span><span class="fl">46.69778</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decimalLongitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">17.90000</span>, <span class="op">-</span><span class="fl">67.91667</span>, <span class="op">-</span><span class="fl">13.25000</span>, <span class="op">-</span><span class="fl">13.82444</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BOLIVIA"</span>, <span class="st">"bolivia"</span>, <span class="st">"Brasil"</span>, <span class="st">"Brazil"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">database_id</span>, <span class="va">scientificName</span>, <span class="va">decimalLatitude</span>,</span></span>
<span class="r-in"><span>  <span class="va">decimalLongitude</span>, <span class="va">country</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get country codes</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">bdc</span><span class="fu">::</span><span class="fu"><a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc_country_standardized</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span>, country <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading auxiliary data: country names</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Standardizing country names</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> country found: Bolivia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> country found: Brazil</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> bdc_country_standardized:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The country names of 3 records were standardized.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Two columns ('country_suggested' and 'countryCode') were added to the database.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">jbd_coordinates_transposed</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  idcol <span class="op">=</span> <span class="st">"database_id"</span>,</span></span>
<span class="r-in"><span>  sci_names <span class="op">=</span> <span class="st">"scientificName"</span>,</span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span></span>
<span class="r-in"><span>  lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span></span>
<span class="r-in"><span>  country <span class="op">=</span> <span class="st">"country_suggested"</span>,</span></span>
<span class="r-in"><span>  countryCode <span class="op">=</span> <span class="st">"countryCode"</span>,</span></span>
<span class="r-in"><span>  border_buffer <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  save_outputs <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="st">"medium"</span></span></span>
<span class="r-in"><span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spherical geometry (s2) switched on</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Correcting latitude and longitude transposed</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 occurrences will be tested</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> jbd_coordinates_transposed:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Corrected 3 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> One columns were added to the database.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   database_id scientificName        decimalLatitude decimalLongitude country</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>           1 Rhinella major                  -<span style="color: #BB0000;">17.9</span>            -<span style="color: #BB0000;">63.4</span> BOLIVIA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>           2 Scinax ruber                    -<span style="color: #BB0000;">14.4</span>            -<span style="color: #BB0000;">67.9</span> bolivia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>           3 Siparuna guianensis             -<span style="color: #BB0000;">13.2</span>            -<span style="color: #BB0000;">41.9</span> Brasil </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>           4 Psychotria vellosiana           -<span style="color: #BB0000;">13.8</span>            -<span style="color: #BB0000;">46.7</span> Brazil </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: country_suggested &lt;chr&gt;, countryCode &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   coordinates_transposed &lt;lgl&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James B. Dorey, Robert L. O’Reilly, Silas Bossert, Erica E. Fischer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

