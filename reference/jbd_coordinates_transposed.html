<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify transposed geographic coordinates — jbd_coordinates_transposed • BeeBDC</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lux/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify transposed geographic coordinates — jbd_coordinates_transposed"><meta property="og:description" content="This function flags and corrects records when latitude and longitude appear
to be transposed.
This function will preferably use the countryCode column generated by
bdc::bdc_country_standardized()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BeeBDC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/BeeBDC_main.html">BeeBDC vignette</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#data-merge">  1.0 Data merge</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#data-preparation">  2.0 Data preparation</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#initial-flags">  3.0 Initial flags</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#taxonomy">  4.0 Taxonomy</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#space">  5.0 Space</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#time">  6.0 Time</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#de-duplication">  7.0 De-duplication</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#data-filtering">  8.0 Data filtering</a>
    </li>
    <li>
      <a href="../articles/BeeBDC_main.html#figures-and-tables">  9.0 Figures and tables</a>
    </li>
    <li>
      <a href="../articles/basic_workflow.html">Basic workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jbdorey/BeeBDC/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify transposed geographic coordinates</h1>
    <small class="dont-index">Source: <a href="https://github.com/jbdorey/BeeBDC/blob/HEAD/R/jbd_coordinates_transposed.R" class="external-link"><code>R/jbd_coordinates_transposed.R</code></a></small>
    <div class="hidden name"><code>jbd_coordinates_transposed.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function flags and corrects records when latitude and longitude appear
to be transposed.
This function will preferably use the countryCode column generated by
<code><a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc::bdc_country_standardized()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jbd_coordinates_transposed</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  idcol <span class="op">=</span> <span class="st">"database_id"</span>,</span>
<span>  sci_names <span class="op">=</span> <span class="st">"scientificName"</span>,</span>
<span>  lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>  lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>  countryCode <span class="op">=</span> <span class="st">"countryCode"</span>,</span>
<span>  border_buffer <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  save_outputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fileName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"large"</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame or tibble. Containing a unique identifier for each record,
geographical coordinates, and country names. Coordinates must be expressed
in decimal degrees and WGS84.</p></dd>


<dt>idcol</dt>
<dd><p>A character string. The column name with a unique record identifier.
Default = "database_id".</p></dd>


<dt>sci_names</dt>
<dd><p>A character string. The column name with species' scientific
names. Default = "scientificName".</p></dd>


<dt>lat</dt>
<dd><p>A character string. The column name with latitudes. Coordinates must
be expressed in decimal degrees and WGS84. Default = "decimalLatitude".</p></dd>


<dt>lon</dt>
<dd><p>A character string. The column name with longitudes. Coordinates must be
expressed in decimal degrees and WGS84. Default = "decimalLongitude".</p></dd>


<dt>country</dt>
<dd><p>A character string. The column name with the country
assignment of each occurrence record. Default = "country".</p></dd>


<dt>countryCode</dt>
<dd><p>A character string. The column name containing an ISO-2 country code for
each record.</p></dd>


<dt>border_buffer</dt>
<dd><p>Numeric. Must have value greater than or equal to 0.
A distance in decimal degrees used to
created a buffer around each country. Records within a given country and at
a specified distance from the border will be not be corrected.
Default = 0.2 (~22 km at the equator).</p></dd>


<dt>save_outputs</dt>
<dd><p>Logical. Indicates if a table containing transposed coordinates should be
saved for further inspection. Default = FALSE.</p></dd>


<dt>fileName</dt>
<dd><p>A character string. The out file's name.</p></dd>


<dt>scale</dt>
<dd><p>Passed to rnaturalearth's ne_countries().
Scale of map to return, one of 110, 50, 10 or 'small', 'medium', 'large'. Default = "large".</p></dd>


<dt>path</dt>
<dd><p>A character string. A path as a character vector for where to create the directories
and save the figures. If
no path is provided (the default), the directories will be created using <code><a href="https://here.r-lib.org//reference/here.html" class="external-link">here::here()</a></code>.</p></dd>


<dt>mc.cores</dt>
<dd><p>Numeric. If &gt; 1, the jbd_correct_coordinates function will run in parallel
using mclapply using the number of cores specified. If = 1 then it will be run using a serial
loop. NOTE: Windows machines must use a value of 1 (see ?parallel::mclapply). Additionally,
be aware that each thread can use large chunks of memory.
Default = 1.#'</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A tibble containing the column "coordinates_transposed" which indicates if
verbatim coordinates were not transposed (TRUE). Otherwise
records are flagged as (FALSE) and, in this case, verbatim coordinates are
replaced by corrected coordinates.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This test identifies transposed coordinates based on mismatches between the
country provided for a record and the record’s latitude and longitude coordinates. Transposed
coordinates often fall outside of the indicated country (i.e., in other
countries or in the sea). Different coordinate transformations are
performed to correct country/coordinates mismatches. Importantly, verbatim
coordinates are replaced by the corrected ones in the returned database. A
database containing verbatim and corrected coordinates is created in
"Output/Check/01_coordinates_transposed.csv" if save_outputs == TRUE. The
columns "country" and "countryCode" can be retrieved by using the function
<a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc::bdc_country_standardized</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">database_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scientificName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Rhinella major"</span>, <span class="st">"Scinax ruber"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Siparuna guianensis"</span>, <span class="st">"Psychotria vellosiana"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decimalLatitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">63.43333</span>, <span class="op">-</span><span class="fl">14.43333</span>, <span class="op">-</span><span class="fl">41.90000</span>, <span class="op">-</span><span class="fl">46.69778</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decimalLongitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">17.90000</span>, <span class="op">-</span><span class="fl">67.91667</span>, <span class="op">-</span><span class="fl">13.25000</span>, <span class="op">-</span><span class="fl">13.82444</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BOLIVIA"</span>, <span class="st">"bolivia"</span>, <span class="st">"Brasil"</span>, <span class="st">"Brazil"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">database_id</span>, <span class="va">scientificName</span>, <span class="va">decimalLatitude</span>,</span></span>
<span class="r-in"><span>  <span class="va">decimalLongitude</span>, <span class="va">country</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get country codes</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">bdc</span><span class="fu">::</span><span class="fu"><a href="https://brunobrr.github.io/bdc/reference/bdc_country_standardized.html" class="external-link">bdc_country_standardized</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span>, country <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading auxiliary data: country names</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Standardizing country names</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> country found: Bolivia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> country found: Brazil</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> bdc_country_standardized:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The country names of 3 records were standardized.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Two columns ('country_suggested' and 'countryCode') were added to the database.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">jbd_coordinates_transposed</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  idcol <span class="op">=</span> <span class="st">"database_id"</span>,</span></span>
<span class="r-in"><span>  sci_names <span class="op">=</span> <span class="st">"scientificName"</span>,</span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span></span>
<span class="r-in"><span>  lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span></span>
<span class="r-in"><span>  country <span class="op">=</span> <span class="st">"country_suggested"</span>,</span></span>
<span class="r-in"><span>  countryCode <span class="op">=</span> <span class="st">"countryCode"</span>,</span></span>
<span class="r-in"><span>  border_buffer <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  save_outputs <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="st">"medium"</span></span></span>
<span class="r-in"><span><span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spherical geometry (s2) switched on</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Correcting latitude and longitude transposed</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 occurrences will be tested</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> jbd_coordinates_transposed:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Corrected 3 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> One columns were added to the database.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   database_id scientificName        decimalLatitude decimalLongitude country</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>           1 Rhinella major                  -<span style="color: #BB0000;">17.9</span>            -<span style="color: #BB0000;">63.4</span> BOLIVIA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>           2 Scinax ruber                    -<span style="color: #BB0000;">14.4</span>            -<span style="color: #BB0000;">67.9</span> bolivia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>           3 Siparuna guianensis             -<span style="color: #BB0000;">13.2</span>            -<span style="color: #BB0000;">41.9</span> Brasil </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>           4 Psychotria vellosiana           -<span style="color: #BB0000;">13.8</span>            -<span style="color: #BB0000;">46.7</span> Brazil </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: country_suggested &lt;chr&gt;, countryCode &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   coordinates_transposed &lt;lgl&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James B. Dorey, Robert L. O’Reilly, Silas Bossert, Erica E. Fischer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

